# Графический клиент утилит Calculate[¶](#Графический-клиент-утилит-Calculate)

* [Графический клиент утилит Calculate](#Графический-клиент-утилит-Calculate)
* [Введение](#Введение)
* [Создание сертификата](#Создание-сертификата)
* [Режимы запуска](#Режимы-запуска)
* [Соединение и работа с сервером утилит](#Соединение-и-работа-с-сервером-утилит)
* [Панель меню](#Панель-меню)
* [Возврат в Главное меню](#Возврат-в-Главное-меню)
* [Запущенные процессы](#Запущенные-процессы)
* [Информация о сессии](#Информация-о-сессии)
* [Настройка программы](#Настройка-программы)
* [Помощь](#Помощь)
* [Выполнение методов на сервере утилит](#Выполнение-методов-на-сервере-утилит)
* [Безопасность и разграничение прав](#Безопасность-и-разграничение-прав)
* [Запросы](#Запросы)
* [Сертификаты](#Сертификаты)
* [Права групп](#Права-групп)

## Введение[¶](#Введение)

Клиент утилит Calculate служит для сетевого доступа по протоколу [https](http://ru.wikipedia.org/wiki/HTTPS) к функциям сервера утилит Calculate 3\. Установить клиент можно при помощи пакета `sys-apps/calculate-console-gui`.

Для запуска клиента выполните команду:

    cl-console-gui

![Главное окно cl-console-gui](/attachments/download/2300)

Рис. 1 Внешний вид окна `cl-console-gui`

## Создание сертификата[¶](#Создание-сертификата)

Для работы с сервером утилит необходим подписанный им сертификат. Для генерации запроса на подписание сертификата (далее запрос) и получения сертификата от сервера утилит используйте пункт **"Сертификаты"** в меню.

![Создание запроса и получение сертификата](/attachments/download/2305)

Рис. 2 Запрос на подпись сертификата

В поле _Хост_ введите адрес хоста сервера утилит, в поле _Порт_ номер порта, который прослушивает сервер (по умолчанию 8888). Используйте кнопку **"Отправить запрос"** для создания и отправления запроса на сервер утилит и кнопку **"Получить сертификат"** для получения подписанного сертификата с сервера утилит.

Для создания запроса и секретного ключа необходимо ввести некоторые данные в окне **"Создание запроса на подпись сертификата"**.

![Создание запроса на подпись сертификата](/attachments/download/2298)

Рис. 3 Создания запроса на подпись сертификата

Большая часть данных, кроме названия организации, города и пароля, будет заполнена автоматически. Не меняйте автоматически подставленные значения, если не уверены, что значения верны. Используйте поле **"Пароль"**, если необходимо дополнительное шифрование закрытого ключа. Введённый пароль будет запрашиваться для установки соединения с сервером утилит.

После создания, запрос автоматически отправится на сервер утилит и появится окно с номером запроса.

![Номер запроса](/attachments/download/2306)

Рис. 4 Информация о номере запроса

Подписать запрос можно на сервере утилит через клиента или с помощью команды:  

    
    cl-core --sign-client n
    

Где n - номер запроса.

После подписания сертификата на сервере, его необходимо забрать нажав на кнопке **"Получить сертификат"** в окне сертификаты. Если запрос ещё не подписан или отвергнут, то появится соответствующее сообщение.

## Режимы запуска[¶](#Режимы-запуска)
Графический клиент может быть запущен в одном из двух режимов:

* запуск в обычном режиме командой  

    
    cl-console-gui
    

* запуск отдельного метода с помощью ключа --method  

    
    cl-console-gui --method methodname
    

Пример запуска установки системы:  

    
    cl-console-gui --method install
    

## Соединение и работа с сервером утилит[¶](#Соединение-и-работа-с-сервером-утилит)

Для соединения с сервером утилит используйте пункт **"Соединиться"** в меню.

![Соединение](/attachments/download/2297)

Рис. 5 Установка соединения с сервером утилит

В поле _Хост_ введите адрес хоста сервера утилит, в поле _Порт_ номер порта, который прослушивает сервер утилит, в поле _Пароль_ введите пароль, если он используется для дополнительного шифрования закрытого ключа. Затем нажмите на кнопку _Соединиться_.

В случае успешного соединения, в главном окне появятся доступные на данном сервере утилит методы (см. раздел _"Выполнение методов на сервере утилит"_).

## Панель меню[¶](#Панель-меню)

После установления соединения с сервером утилит верхнее меню приобретает вид, показанный на предыдущем изображении и состоит из кнопок: _"Назад"_ (кроме главного меню), _"Процессы"_, _"Сессия"_, _"Отсоединиться"_, _"Настройки"_ и _"Помощь"_.

### Возврат в Главное меню[¶](#Возврат-в-Главное-меню)

Для возврата в главное меню служит кнопка **"Назад"** в главном меню. При отображении главного меню кнопка не отображается.

### Запущенные процессы[¶](#Запущенные-процессы)

Кнопка **"Процессы"** в панели меню покажет информацию о запущенных процессах. К работающему процессу можно подключиться, прервать его выполнение или просмотреть результат работы.

![Просмотр запущенных процессов](/attachments/download/2339)

Рис. 6 Просмотр информации о запущенных процессах

### Информация о сессии[¶](#Информация-о-сессии)

Кнопка **"Сессия"** в панели меню отобразит окно с информацией о текущей сессии с возможностью очистить на сервере кэш процессов, принадлежащих данной сессии.

![Информация о сессии](/attachments/download/2308)

Рис. 7 Информация о текущей сессии
Кнопка **"Отсоединиться"** в панели меню отобразит диалоговое окно закрытия сессии и тремя действиями:

* "Да" - отсоединиться и закрыть сессию.
* "Нет" - Отсоединиться, но не закрывать сессию.
* "Отмена" - не отсоединяться.

![Закрытие сессии](/attachments/download/2307)

Рис. 8 Закрытие сессии

### Настройка программы[¶](#Настройка-программы)

Кнопка **"Настройки"** в панели меню служит для вызова окна настроек параметров Calculate Console и состоит из вкладок _"Настройки интерфейса"_ и _"Прочие настройки"_.
Вкладка "Настройки интерфейса" включает поля:

* _"Расширенный просмотр"_ - устанавливает режим просмотра результатов работы процесса: расширенный или сокращённый.
* _"Высота изображений"_ - устанавливает фиксированную высоту изображений (0 - убрать изображения).
* _"Количество строк в таблице"_ - устанавливает максимальное количество строк в таблицах, находящихся в результатах работы процесса и отображающих списки (например, список запросов на подпись сертификата).

![Настройки (1 вкладка)](/attachments/download/2312)

Рис. 9 Настройка интерфейса
Вкладка "Прочие настройки" включает поля:

* _"Выбор языка"_ - устанавливает язык интерфейса.
* _"Директория с сертификатами"_ - устанавливает директорию, где находятся сертификаты клиента (при хранении их не в стандартной директории или на внешнем носителе).

![Настройки (2 вкладка)](/attachments/download/2313)

Рис. 10 Прочие настройки программы

### Помощь[¶](#Помощь)
Кнопка **"Помощь"** в панели меню отобразит подменю из пунктов:

* _"О программе"_ - выведет окно с информацией о Calculate Console
* _"Справка"_ - откроет веб-страницу с этим руководством.
* _"Сообщить об ошибке"_ - отобразит окно для отправки сообщения об ошибке разработчикам:

![Сообщение об ошибке](/attachments/download/2296)

Рис. 11 Окно отправки сообщения об ошибке

## Выполнение методов на сервере утилит[¶](#Выполнение-методов-на-сервере-утилит)

После соединения с сервером утилит в Главном окне появятся доступные для данного сертификата методы:

![Доступные действия на сервере утилит](/attachments/download/2301)

Рис. 12 Главное окно с доступными методами

Все методы разделены по категориям. При открытии метода откроется окно с необходимыми данными. Методы могут состоять из одного шага:

![Действие с одним шагом](/attachments/download/2302)

Рис. 13 Метод настройки видеокарты

Или из нескольких шагов:

![Действие с несколькими шагами](/attachments/download/2303)

Рис. 14 Настройка видеокарты, как один из шагов метода установки системы

По шагам можно перемещаться, используя кнопки "Назад" и "Далее" или выбрав нужный шаг в списке слева. Начать выполнение метода можно только из последнего шага.

При выполнении метода откроется окно с результатами работы процесса. Во время выполнения, процесс можно прервать, нажав на кнопку "Прервать процесс".

По завершении работы процесса можно вернуться назад с помощью кнопки "Назад" в верхнем меню или закрыть процесс, нажав на кнопку "Закрыть". В этом случае данные о его работе будут удалены на сервере утилит и не будут отображаться в окне "Просмотр информации о запущенных процессах".

## Безопасность и разграничение прав[¶](#Безопасность-и-разграничение-прав)

Как уже упоминалось, для взаимодействия графического клиента с сервером утилит Calculate используется протокол "https", который позволяет зашифровывать передаваемые данные, используя сертификаты и ключи. Процесс получения сертификата описан ранее в разделе _"Создание сертификата"_. В данном разделе речь пойдёт о подписании запросов и разграничении прав доступа по сертификатам.

### Запросы[¶](#Запросы)

Запрос на подпись сертификата создаётся на стороне клиента после создания открытого и секретного ключей, и передаётся серверу утилит для подписания сертификата.

В графическом клиенте для работы с запросами на сервере утилит используется метод **"Просмотр запросов"** в категории утилиты.

![Просмотр запросов](/attachments/download/2310)

Рис. 15 Просмотр запросов

Для выбора запроса необходимо нажать на строку таблицы, после чего откроется окно с информацией о запросе, где можно изменить номер запроса (при этом данные о запросе не обновляются) и группу будущего сертификата.  
Выбранный запрос можно подписать _"Подтвердить"_ или отказать в подписании _"Удалить"_. Подписанный запрос, сертификат которого не забран клиентом, будет отображаться в таблице _"Просмотр запросов"_ с названием группы в столбце _"Группа"_.

![Подробности запроса](/attachments/download/2299)

Рис. 16 Просмотр запросов

### Сертификаты[¶](#Сертификаты)

Сертификат подтверждает соответствие между открытым ключом и информацией, идентифицирующей владельца ключа. Кроме того, в утилитах Calculate сертификаты используются для разграничения прав доступа с помощью указания в них группы прав.

При генерации сертификата для него устанавливается группа прав. Права записывается в одно из полей сертификата и не подлежат изменению.

### Права групп[¶](#Права-групп)

Права групп служат для разграничения прав на сервере утилит и указываются в сертификате клиента. Каждой группе соответствует список прав, к которым данная группа имеет доступ.

Права для групп сертификатов по умолчанию хранятся в файле `/var/calculate/server/conf/group_right.conf` в следующем виде: `group right1[, right2[,right3...]]`, например  

    
    manager install, get-sessions, request
    user get-sessions,request,view_cert
    

Для изменения прав конкретного сертификата используется файл `/var/calculate/server/conf/right.conf`, куда необходимо вписать права и номера сертификатов.

Пример:  

    
    install 1 2 -3
    

Для сертификатов с номерами `1` и `2` добавить право на метод "install" и удалить его для сертификата с номером `3`.  
Права для конкретного сертификата имеют приоритет перед правами для группы сертификата.

Для управления правами групп на сервере утилит в клиенте используется метод **"Просмотр групп"** в категории утилиты.

![Просмотр групп](/attachments/download/2314)

Рис. 17 Просмотр групп

Для добавления новой группы нажмите на кнопку "+" (плюс). В открытом действии **"Добавление группы"** введите имя создаваемой группы в поле _"Имя группы"_ и выберите права для группы в поле _"Права группы"_.

Для выбора группы необходимо нажать на строку таблицы, после чего откроется **"Подробности группы"**, где можно изменить права либо удалить группу.