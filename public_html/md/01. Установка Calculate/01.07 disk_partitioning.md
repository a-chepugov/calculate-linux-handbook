# Разбиение диска[¶](#Разбиение-диска)

## Общая схема[¶](#Общая-схема)

[Calculate Linux](Calculate Linux.html) можно переустановить без каких-либо дополнительных параметров при следующем разбиении диска:  

    
    /dev/sda1 swap
    /dev/sda2 10-20Gb Linux (/)
    /dev/sda3 10-20Gb Linux (/)
    /dev/sda4 Extended
    /dev/sda5 Linux (/home)
    ... (другие диски и разделы)
    

Если система загружена с раздела ''sda2'', то при переустановке системы установщик предложит ''sda3'', и наоборот. Программа установки помнит, с какого раздела производилась установка системы, и в дальнейшем предложит выполнить обновление в предыдущий раздел.

В настольной версии системы ''swap''-раздел может отсутствовать вовсе при достаточном количестве оперативной памяти (2 Гб и выше). В этом случае ядро практически не будет "свопить", интенсивнее высвобождая память.

## Преимущества общей схемы[¶](#Преимущества-общей-схемы)

* **защищённость** - пользовательские данные, размещенные на отдельном разделе, никогда не пострадают при переустановке системы;
* **свободное место** - у вас всегда будет свободное место на диске, т.к. вероятность, что какому-то разделу (например, `/boot`) не хватит места, сведена к минимуму;
* **обновление системы** - вы сможете выполнять обновление, продолжая работать в системе;
* **надёжность** - вы всегда сможете загрузиться в предыдущую систему, если новая по какой-либо причине будет работать нестабильно.

## Настройки[¶](#Настройки)

Для подключения дополнительных разделов к системе используйте файл `/etc/fstab`.

Для монтирования раздела в директорию `/home` достаточно в конец файла `/etc/fstab` вписать строку примерно следующего содержания:  

    
    /dev/sda5   /home   ext4   noatime   0 0
    

В приведенном примере раздел _sda5_ с файловой системой _ext4_ монтируется в директорию `/home`.

Для подключения раздела выполните:  

    
    mount /home
    

Прописанный таким образом раздел будет автоматически монтироваться во время загрузки системы.

При переустановке системы _Calculate_ будет переносить точки монтирования из файла `/etc/fstab` в новую систему.

## Разбиение диска для сервера[¶](#Разбиение-диска-для-сервера)

Для разбиения диска под [Calculate Directory Server](Calculate Directory Server.html) мы предлагаем использовать следующую схему:  

    
    /dev/sda1 swap
    /dev/sda2 20Gb Linux (/, ext4)
    /dev/sda3 20Gb Linux (/, ext4)
    /dev/sda4 Extended
    /dev/sda5 Linux (/var/calculate, xfs)
    

Размер диска подкачки (swap) следует выбрать произвольно, исходя из объема оперативной памяти и предполагаемой нагрузки. Как правило, рекомендуют использовать в 2 раза больше, чем объём оперативной памяти.

По мере необходимости вы можете расширить ёмкость разделов, подключив дополнительные диски:  

    
    /dev/sdb1 Linux (/var/calculate/server-data, xfs)
    /dev/sdc1 Linux (/var/calculate/server-data/samba/share, xfs)
    

Различные файловые системы имеют свои преимущества и недостатки. Мы можем оставить здесь лишь рекомендацию на основе личного опыта. В качестве файловой системы для корневого раздела хорошо зарекомендовала себя ''ext4'', а вот для хранения файлов, благодаря активному использованию кэша, идеальной, на наш взгляд, является ''xfs''.

## Разбиение диска для Linux-десктопа[¶](#Разбиение-диска-для-Linux-десктопа)

Настраивая [Calculate Linux Desktop](Calculate Linux Desktop.html) для работы в качестве клиента сервера [CDS](CDS.html), мы рекомендуем разбить жесткий диск следующим образом:  

    
    /dev/sda1 swap
    /dev/sda2 10Gb Linux (/, ext4)
    /dev/sda3 10Gb Linux (/, ext4)
    /dev/sda4 Extended
    /dev/sda5 Linux (/var/calculate, ext4)
    

Обратите внимание, что свободный раздел монтируется в `/var/calculate`. Таким образом, настройки подключения к серверу сохраняются в отдельном разделе, упрощая переустановку системы.

Содержимое раздела `/home` не будет теряться при переустановке, т.к. после входа в домен CDS, директория `/home` располагается в `/var/calculate/home` (монтируется через _bind_). Сохранять данные имеет смысл только для кэширования.

## Переустановка системы[¶](#Переустановка-системы)

При любом разбиении диска архивы с обновлениями удобно хранить в отдельном разделе - пусть это будет, например, `/home` (если он вынесен на отдельный раздел).  
Подключить такой диск можно, используя следующую запись в `/etc/fstab`:  

    
    /home/calculate /usr/calculate/share none bind 0 0