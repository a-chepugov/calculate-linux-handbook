# Загрузка модулей ядра[¶](#Загрузка-модулей-ядра)

## Формат OpenRC[¶](#Формат-OpenRC)

Для управления автоматической загрузкой модулей ядра в Gentoo используется файл `/etc/conf.d/modules`. В этом файле можно определить список модулей как для определенной версии ядра, так и для релиза ядра или основной версии ядра. Причем в автозагрузке используется только один параметр, точнее указывающий на версию версии ядра.

Например, если есть параметры:  

    
    modules_3="mperf" 
    modules_3_6="acpi-cpufreq" 
    

то для ядра 3.6.x будет загружен модуль `acpi-cpufreq`, для всех остальных ядер 3.x будет загружен `mperf`. Использование только одного параметра затрудняет управление списком загружаемых модулей в зависимости от параметров системы, состава пакетов.

## Система загрузки модулей в Calculate Linux[¶](#Система-загрузки-модулей-в-Calculate-Linux)

Для удобного управления загрузкой модулей ядра в `/etc/conf.d/modules` добавлен код, загружающей модули из конфигурационных файлов в директории `/etc/modules-load.d`. Используя шаблоны можно создавать конфигурационные файлы со списками в зависимости от версии ядра, версии определенных пакетов и т.д. Например шаблонами оверлея при установке пакета `virtualbox-modules` в автозагрузку будут добавлены модули `vboxdrv`, `vboxnetflt` и `vboxnetadp` в файле `/etc/modules-load.d/virtualbox.conf`.

## Формат файлов[¶](#Формат-файлов)

Конфигурационные файлы описывающих модули находятся в директории `/etc/modules-load.d` и имеют расширение ".conf". Файлы состоят из списка имен модулей ядра, разделенных переводом строки. Пустые строки и строки начинающиеся с "\#" или ";" игнорируются. Списки не поддерживают указание параметров модулей ядра - для указания параметров используйте `/etc/modprobe.d`.

## Миграция на новый формат[¶](#Миграция-на-новый-формат)

При выполнении обновления eix-sync будет создан файл копии старых настроек `/etc/conf.d/modules.old`, пользовательские модули будут перенесены в файл `/etc/modules-load.d/migrate.conf`. В процессе миграции будут пропущены модули управления частотой процессора, т.к. они подгружаются автоматически при изменении параметров частоты.