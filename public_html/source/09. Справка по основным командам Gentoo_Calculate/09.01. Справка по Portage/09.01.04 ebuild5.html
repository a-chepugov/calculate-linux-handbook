<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>ebuild5</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style>
body { font:80% Verdana,Tahoma,Arial,sans-serif; }
h1, h2, h3, h4 {  font-family: "Trebuchet MS",Georgia,"Times New Roman",serif; }
ul.toc { padding: 4px; margin-left: 0; }
ul.toc li { list-style-type:none; }
ul.toc li.heading2 { margin-left: 1em; }
ul.toc li.heading3 { margin-left: 2em; }
a.wiki-anchor { display: none; margin-left: 6px; text-decoration: none; }
a.wiki-anchor:hover { color: #aaa !important; text-decoration: none; }
h1:hover a.wiki-anchor, h2:hover a.wiki-anchor, h3:hover a.wiki-anchor { display: inline; color: #ddd; }
pre {font-size:133% }
</style>
</head>
<body>
<h1 id="EBUILD-5">EBUILD (5)<a href="#EBUILD-5" class="wiki-anchor">&para;</a></h1>


	<h2 id="НАЗВАНИЕ">НАЗВАНИЕ<a href="#НАЗВАНИЕ" class="wiki-anchor">&para;</a></h2>


	<p>ebuild - внутренний формат, переменные и функции в сценарии ebuild</p>


	<h2 id="ОПИСАНИЕ">ОПИСАНИЕ<a href="#ОПИСАНИЕ" class="wiki-anchor">&para;</a></h2>


	<p>Программа <strong><a href="ebuild.html" class="wiki-page">ebuild</a></strong> (1) может принять в качестве аргумента только один сценарий ebuild. Сценарий ebuild содержит переменные и команды, которые определяют, каким образом следует загружать исходный код того или иного программного пакета, распаковывать его, накладывать патчи, компилировать, устанавливать и включать в дерево. Кроме того, в сценарий также входят команды, которые должны выполняться до и после установки/удаления пакетов. Все сценарии ebuild написаны на bash.</p>


	<h3 id="Атомы-зависимости">Атомы зависимости<a href="#Атомы-зависимости" class="wiki-anchor">&para;</a></h3>


	<p><em>Атомы зависимости</em> представляют собой не что иное как зависимости, к которым будет обращаться portage, выявляя отношения между пакетами. Обратите внимание, что если атом еще не в дереве пакетов, значение переменной совпадает с последней доступной версией.</p>


	<p><strong>Базовые</strong> <strong>атомы</strong></p>


	<p style="padding-left:4em;">Базовый атом - это полное имя пакета: категория/пакет.</p>


	<p style="padding-left:4em;">Вот примеры базовых атомов: <br /><pre style="margin-left:4.0em;">
    sys-apps/sed 
    sys-libs/zlib 
    net-misc/dhcp 
</pre></p>


	<p><strong>Версии атомов</strong></p>


	<p style="padding-left:4em;">Иногда необходимо уточнение, что подойдут лишь определенные версии атомов. Обратите внимание, что в этом случае их нужно указывать с префиксом (см. ниже). Иными словами, номер версии просто добавляется как суффикс к базовому атому.</p>


	<p style="padding-left:4em;">Примеры: <br /><pre style="margin-left:4.0em;">
    sys-apps/sed-4.0.5 
    sys-libs/zlib-1.1.4-r1 
    net-misc/dhcp-3.0_p2 
</pre></p>


	<p style="padding-left:4em;">Номера версий обычно состоят из двух или трех чисел, разделенных точками, например, 1.2 или 4.5.2. После этой строки может идти буква - например, возможны такие номера версий как 1.2a или 4.5.2z. Имейте в виду, что эта буква <em>не обозначает</em> альфа- или бета-версию. Для этого используется специальный необязательный суффикс: _alpha, _beta, _pre (предрелиз), _rc (кандидат в релизы) или _p (патч). Таким образом, третий предрелиз пакета будет обозначен, например, как 1.2_pre3. Суффиксы можно добавлять один за другим в неограниченном количестве.</p>


	<p><strong>Префиксные операторы атома [> >= = <= <]</strong></p>


	<p style="padding-left:4em;">Иногда необходимо задать зависимость от группы версий, не указывая явно каждую из них. Для этого удобно использовать стандартные булевы операторы.</p>


	<p style="padding-left:4em;">Примеры: <br /><pre style="margin-left:4.0em;">
    &gt;media-libs/libgd-1.6 
    &gt;=media-libs/libgd-1.6 
    =media-libs/libgd-1.6 
    &lt;=media-libs/libgd-1.6 
    &lt;media-libs/libgd-1.6 
</pre></p>


	<p><strong>Расширенные префиксы [!~]и суффиксы атома [*]</strong></p>


	<p style="padding-left:4em;">Для большей точности возможно указывать блокирующие пакеты и соответствующие им диапазоны версий. Обратите внимание, что эти дополнительные префиксы/суффиксы можно сочетать любым способом с классами атомов, о которых шла речь выше.</p>


	<p style="padding-left:4em;"><em>~</em></p>


	<p style="padding-left:8em;">означает любую ревизию указанной базовой версии. Так, в приведенном выше примере в выборке окажутся версии '1.0.2a', '1.0.2a-r1', '1.0.2a-r2' и т.д.</p>


	<p style="padding-left:8em;">Пример: <br /><pre style="margin-left:8.0em;">
    ~net-libs/libnet-1.0.2a 
</pre></p>


	<p style="padding-left:4em;"><em>!</em></p>


	<p style="padding-left:8em;">предотвращает одновременную установку пакетов, блокирующих друг друга.</p>


	<p style="padding-left:8em;">Пример: <br /><pre style="margin-left:8.0em;">
    !app-text/dos2unix 
</pre></p>


	<p style="padding-left:4em;"><em>!!</em></p>


	<p style="padding-left:8em;">предотвращает одновременную установку пакетов и при этом явно запрещает их одновременную временную установку в серии обновлений. Данный синтаксис поддерживается в <strong>EAPI 2</strong> и выше.</p>


	<p style="padding-left:8em;">Пример: <br /><pre style="margin-left:8.0em;">
    !!&lt;sys-apps/portage-2.1.4_rc1 
</pre></p>


	<p style="padding-left:4em;"><em>*</em></p>


	<p style="padding-left:8em;">означает любую версию пакета при условии совпадения указанного префикса строки. Таким образом, если в качестве версии указано '2*', будут учитываться версии '2.1', '2.2', '2.2.1' и т.п., но не '1.0', '3.0', '4.1' и т.д. Не забудьте: в силу того, что вы используете подстановочный знак, шаблону '2*' будет соответствовать и '20'. Часть версии перед '*' должна быть корректным номером версии, без '*'.. Например, '2' - корректный номер версии, а '2.' - нет. Иными словами, вы можете использовать обозначение '2*', но не '2.*'.</p>


	<p style="padding-left:8em;">Примеры: <br /><pre style="margin-left:8.0em;">
    =dev-libs/glib-2* 
    !=net-fs/samba-2* 
</pre></p>


	<p><strong>Слоты атомов</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 1</strong> может быть задан <strong>слот</strong> любого атома. Для этого необходимо указать имя <strong>слота</strong>, через двоеточие.</p>


	<p style="padding-left:4em;">Например: <br /><pre style="margin-left:4.0em;">
    x11-libs/qt:3 
    ~x11-libs/qt-3.3.8:3 
    &gt;=x11-libs/qt-3.3.8:3 
    =x11-libs/qt-3.3*:3 
</pre></p>


	<p><strong>Подслоты</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 5</strong> зависимость слота может содержать опциональный подслот, который указывается через слэш <em>/</em>.</p>


	<p style="padding-left:4em;">Примеры: <br /><pre style="margin-left:4.0em;">
    dev-libs/icu:0/0 
    dev-libs/icu:0/49 
    dev-lang/perl:0/5.12 
    dev-libs/glib:2/2.30 
</pre></p>


	<p><strong>Операторы атомов слотов</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 5</strong>, оператором слота выступает двоеточие, за которым следует один из следующих операторов:</p>


	<p style="padding-left:4em;"><em>*</em></p>


	<p style="padding-left:8em;">Означает, что разрешается любое значение слота. Кроме того, для сборочных зависимостей обозначает, что пакет, совпадающий с запросом, может быть удалён и заменён другим совпадающим в другом слоте.</p>


	<p style="padding-left:8em;">Примеры: <br /><pre style="margin-left:8.0em;">
    dev-libs/icu:* 
    dev-lang/perl:* 
    dev-libs/glib:* 
</pre></p>


	<p style="padding-left:4em;"><em>=</em></p>


	<p style="padding-left:8em;">Означает,что допускается любое значение слота. Кроме того, для сборочных зависимостей означает, что слот и подслот пакета, совпадающего с запросом, обязательно должны совпадать со слотом и подслотом последней присутствующей в системе на момент установки версии.</p>


	<p style="padding-left:8em;">Примеры: <br /><pre style="margin-left:8.0em;">
    dev-libs/icu:= 
    dev-lang/perl:= 
    dev-libs/glib:= 
</pre></p>


	<p style="padding-left:4em;"><em>slot=</em></p>


	<p style="padding-left:8em;">Означает то же, что и оператор равенства, за исключением того, что для слота допускается лишь одно определённое значение.</p>


	<p style="padding-left:8em;">Примеры: <br /><pre style="margin-left:8.0em;">
    dev-libs/icu:0= 
    dev-lang/perl:0= 
    dev-libs/glib:2= 
</pre></p>


	<p>Чтобы использовать оператор равенства слота, пакетный менеджер должен сохранить пару слот/подслот новейшей установленной версии пакета. Описанный синтаксис обрабатывается только пакетным менеджером и не предназначен для ебилдов. Для этого пакетный менеджер при сохранении зависимостей пакета может вставлять соответствующий слот/подслот между двоеточием и знаком равенства. Обозначение подслота в этом случае опускать нельзя (когда это делает переменная SLOT, подразумевается, что пакет имеет подслот, совпадающий со слотом).</p>


	<p>Примеры: <br /><pre>
    dev-libs/icu:0/0= 
    dev-libs/icu:0/49= 
    dev-lang/perl:0/5.12= 
    dev-libs/glib:2/2.30= 
</pre></p>


	<p><strong>USE-флаги атомов</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 2</strong> для любого атома могут быть заданы <strong>USE</strong> -флаги. Если при этом вы также указываете <strong>слоты</strong>, то зависимости <strong>USE</strong> -флагов будут выводится справа от зависимостей <strong>слотов</strong>.</p>


	<p style="padding-left:4em;"><strong>Безусловные USE-зависимости</strong></p>


	<table style="margin-left:8em;;">
		<tr>
			<td>Пример</td>
			<td>Расшифровка</td>
		</tr>
		<tr>
			<td>foo[bar]</td>
			<td>foo требует, чтобы был включен bar</td>
		</tr>
		<tr>
			<td>foo[bar,baz]</td>
			<td>foo требует, чтобы были включены и bar, и baz</td>
		</tr>
		<tr>
			<td>foo[-bar,baz]</td>
			<td>foo требует, чтобы bar был отключен, а baz включен</td>
		</tr>
	</table>




	<p style="padding-left:4em;"><strong>Условные USE-зависимости</strong></p>


	<table style="margin-left:8em;;">
		<tr>
			<td>Краткая запись</td>
			<td>Развернутая запись</td>
		</tr>
		<tr>
			<td>foo[bar?]</td>
			<td>bar? ( foo[bar] ) !bar? ( foo )</td>
		</tr>
		<tr>
			<td>foo[!bar?]</td>
			<td>bar? ( foo ) !bar? ( foo[-bar] )</td>
		</tr>
		<tr>
			<td>foo[bar=]</td>
			<td>bar? ( foo[bar] ) !bar? ( foo[-bar] )</td>
		</tr>
		<tr>
			<td>foo[!bar=]</td>
			<td>bar? ( foo[-bar] ) !bar? ( foo[bar] )</td>
		</tr>
	</table>




	<p><strong>USE-флаги атомов по умолчанию</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> <strong>USE-</strong> зависимости умеют устанавливать значения по умолчанию для флагов, которые могут быть не прописаны в <strong>IUSE</strong> для данного пакета. Для этого непосредственно вслед за флагом поставьте соответственно <strong>(+)</strong> или <strong>(-)</strong>: <strong>(+)</strong> указывает системе вести себя так, словно отсутствующий флаг присутствует и включен, <strong>(-)</strong> - так, словно отсутствующий флаг присутствует, но отключен.</p>


<pre style="margin-left:4.0em;">
media-video/ffmpeg[threads(+)] 
media-video/ffmpeg[threads(-)] 
</pre>

	<p><strong>Динамические зависимости</strong></p>


	<p style="padding-left:4em;">Зачастую программы могут иметь различные зависимости при различных USE-флагах. Система портежей предлагает несколько опций для учета этого. Заметьте, что каждая синтаксическая конструкция из числа описанных ниже каждая конструкция рассматривается как один атом в соответствующем контексте. Таким образом, каждый атом за счет задания условий может включать несколько атомов, и эта вложенность может быть любой глубины.</p>


	<p style="padding-left:4em;"><strong>переменная_use? ( атом )</strong></p>


	<p style="padding-left:8em;">Так, чтобы включить библиотеку jpeg, при указании пользователем jpeg в переменной <strong>USE</strong>, используйте следующую конструкцию:</p>


	<p style="padding-left:8em;">jpeg? ( media-libs/jpeg )</p>


	<p style="padding-left:4em;"><strong>!переменная_use? ( атом )</strong></p>


	<p style="padding-left:8em;">Если пакет необходимо включать только при отсутствии определенной опции в пользовательском значении переменной USE, используйте конструкцию, подобную:</p>


	<p style="padding-left:8em;">!nophysfs? ( dev-games/physfs )</p>


	<p style="padding-left:8em;">Это удобно в том случае, если вы хотите добавить необязательную поддержку той или иной возможности и установливать ее по умолчанию.</p>


	<p style="padding-left:4em;"><strong>переменная_use? ( атом, если истинно ) !переменная_use? ( атом, если ложно )</strong></p>


	<p style="padding-left:8em;">Для обработки аналогично тернарному оператору языка C используйте два утверждения, одно прямое, другое обратное. Так, если пакет использует GTK2 или GTK1, но не оба вместе, это можно выразить следующим образом:</p>


	<p style="padding-left:8em;">gtk2? ( =x11-libs/gtk+-2* ) !gtk2? ( =x11-libs/gtk+-1* )</p>


	<p style="padding-left:8em;">В результате по умолчанию будет использоваться более новая библиотека, GTK2.</p>


	<p style="padding-left:4em;"><strong>|| ( Atom Atom ... )</strong></p>


	<p style="padding-left:8em;">Если пакет может работать с несколькими различными пакетами, но категория virtual не подходит, может быть использован следующий синтаксис:</p>


<pre style="margin-left:8.0em;">
|| ( 
    app-games/unreal-tournament 
    app-games/unreal-tournament-goty 
) 
</pre>

	<p style="padding-left:8em;">В приведенном примере мы видим, что пакет unreal-tournament существует в обычной версии и в версии goty. Поскольку обе они предоставляют один и тот же базовый набор файлов, другой пакет может использовать любой из них. Добавление категории virtual не подходит, поскольку она не охватывает соответствующие файлы.</p>


	<p style="padding-left:8em;">Другой уместный случай использования данной конструкции - это когда пакет может быть собран с различными видео-интерфейсами, но не может использовать их одновременно.</p>


	<p style="padding-left:8em;">Например: <br /><pre style="margin-left:8.0em;">
|| ( 
    sdl? ( media-libs/libsdl ) 
    svga? ( media-libs/svgalib ) 
    opengl? ( virtual/opengl ) 
    ggi? ( media-libs/libggi ) 
    virtual/x11 
) 
</pre></p>


	<p style="padding-left:8em;">В данном случае будет выбран только один из пакетов, а приоритет определяется порядком их перечисления. Поэтому наиболее вероятным кандидатом является библиотека sdl, далее идут svga, opengl, ggi - и, наконец, по умолчанию, если пользователь не задал явно одну из предлагаемых библиотек, будет использоваться X.</p>


	<p style="padding-left:8em;">Имейте в виду, что, если один из перечисленных пакетов уже установлен, менеджер пакетов будет руководствоваться этим для удовлетворения зависимости.</p>


	<h3 id="-Перекрёстная-компиляция"> Перекрёстная компиляция<a href="#-Перекрёстная-компиляция" class="wiki-anchor">&para;</a></h3>


	<p>Portage поддерживает перекрёстную компиляцию в каталоге, определяемом переменной <strong>ROOT</strong>.</p>


	<p><strong>Хост</strong></p>


	<p style="padding-left:4em;">В данном случае под <em>хостом</em> понимается платформа, на которой разворачивается процесс сборки - в системе сборки GNU это значение переменной CBUILD. Пакеты хоста хранятся в корневом каталоге системы ("<em>/</em>").</p>


	<p style="padding-left:4em;">Если <strong>ROOT</strong> - "<em>/</em>", сюда будут устанавливаться все типы зависимостей. Если это не так, для EAPI, поддерживающих переменную <strong>HDEPEND</strong> (экспериментальный <strong>EAPI 5-hdepend</strong>), в каталог "<em>/</em>" будут устанавливаться только пакеты <strong>HDEPEND</strong>. Для EAPI без поддержки <strong>HDEPEND</strong> это поведение управляется опцией t <em>--root-deps</em> команды <strong>emerge</strong>(1); по умолчанию в _хост_ будут устанавливаться только пакеты  <strong>DEPEND</strong>.</p>


	<p><strong>Цель</strong></p>


	<p style="padding-left:4em;">Под <em>целью</em> подразумевается платформа, на которой пакет в дальнейшем будет работать - в системе сборки GNU это значение переменной CHOST. Каталог, где располагается данная система, определяется переменной <strong>ROOT</strong>. Если этот каталог - не "<em>/</em>", то есть если <em>хост</em> и <em>цель</em> не совпадают, то путь, который хранится в переменной, указывает на каталог, в котором находится <em>цель</em>.</p>


	<p style="padding-left:4em;">Для EAPI с поддержкой <strong>HDEPEND</strong> (экспериментальный <strong>EAPI 5-hdepend</strong>), переменные <strong>DEPEND</strong>, <strong>RDEPEND</strong> и <strong>PDEPEND</strong> содержат списки зависимостей <em>цели</em> - иными словами, перечни пакетов, которые должны быть установлены в каталог <strong>ROOT</strong>. Для EAPI, которые не поддерживают <strong>HDEPEND</strong>, за установку в этот каталог отвечает опция <em>--root-deps</em> пакетного менеджера <strong>emerge</strong>(1). Если данная опция не включена, <strong>emerge</strong> по умолчанию будет устанавливать сборочные зависимости (то есть пакеты <strong>RDEPEND</strong> и <strong>PDEPEND</strong>) только в каталог <strong>ROOT</strong>.</p>


	<p>Подробнее о переменных <strong>DEPEND</strong>, <strong>RDEPEND</strong> и <strong>HDEPEND</strong> см. в разделе <strong>ПЕРЕМЕННЫЕ</strong>.</p>


	<p><strong>USE-флаг targetroot</strong></p>


	<p style="padding-left:4em;">Для EAPI, которые поддерживают USE-флаг "<em>targetroot</em>", пакетный менеджер автоматически включает данный флаг, если <em>host</em> и <em>target</em> не совпадают - иными словами, если значение <strong>ROOT</strong> - не "<em>/</em>". Это необходимо в том случае, если пакету в процессе сборки требуется исполняемая копия себя самого. Распространённым примером такой ситуации может служить пакет dev-lang/python, который при компиляции требует запуска интерпретатора Python.</p>


	<h2 id="ПЕРЕМЕННЫЕ">ПЕРЕМЕННЫЕ<a href="#ПЕРЕМЕННЫЕ" class="wiki-anchor">&para;</a></h2>


	<p><strong>Замечания по синтаксису</strong></p>


	<p style="padding-left:4em;">- В сценариях ebuild можно использовать все переменные, определенные в <strong><a href=".html" class="wiki-page">make.conf</a></strong>(5) (такие как <strong>PORTAGE</strong> и <strong>PORTDIR</strong>) <br /> - Присваивая значения переменным в сценарии, <strong>нельзя оставлять пробел</strong> между именем переменной и знаком равенства. <br /> - Значения переменных могут содержать только символы из таблицы <strong>ascii</strong>(7). Это требование <strong>GLEP 31</strong>.</p>


	<p><strong>P</strong></p>


	<p style="padding-left:4em;">Эта переменная содержит имя пакета без указания ревизии сценария. Ее НЕЛЬЗЯ изменять.</p>


	<p style="padding-left:4em;">xfree-4.2.1-r2.ebuild --&gt; $P=='xfree-4.2.1'</p>


	<p><strong>PN</strong></p>


	<p style="padding-left:4em;">Содержит имя сценария без номера версии.</p>


	<p style="padding-left:4em;">xfree-4.2.1-r2.ebuild --&gt; $PN=='xfree'</p>


	<p><strong>PV</strong></p>


	<p style="padding-left:4em;">Содержит номер версии без указания ревизии.</p>


	<p style="padding-left:4em;">xfree-4.2.1-r2.ebuild --&gt; $PV=='4.2.1'</p>


	<p><strong>PR</strong></p>


	<p style="padding-left:4em;">Содержит номер ревизии или, если его не существует, 'r0'.</p>


	<p style="padding-left:4em;">xfree-4.2.1-r2.ebuild --&gt; $PR=='r2'</p>


	<p><strong>PVR</strong></p>


	<p style="padding-left:4em;">Содержит номер версии с указанием ревизии.</p>


	<p style="padding-left:4em;">xfree-4.2.1-r2.ebuild --&gt; $PVR=='4.2.1-r2'</p>


	<p><strong>PF</strong></p>


	<p style="padding-left:4em;">Содержит полное имя пакета <strong>PN</strong>-<strong>PVR</strong></p>


	<p style="padding-left:4em;">xfree-4.2.1-r2.ebuild --&gt; $PF=='xfree-4.2.1-r2'</p>


	<p><strong>КАТЕГОРИЯ</strong></p>


	<p style="padding-left:4em;">Содержит имя категории пакета.</p>


	<p><strong>A</strong></p>


	<p style="padding-left:4em;">CСодержит все исходные файлы, необходимые пакету. Эта переменная не должна определяться: она генерируется автоматически на основе переменной <strong>SRC_URI</strong>.</p>


	<p><strong>WORKDIR</strong> = <em> ${PORTAGE_TMPDIR}/portage/${CATEGORY}/${PF}/work</em></p>


	<p style="padding-left:4em;">Содержит путь доступа к корневому каталогу сборки пакета. Не изменяйте эту переменную.</p>


	<p><strong>FILESDIR</strong> = <em> ${PORTDIR}/${CATEGORY}/${PN}/files</em></p>


	<p style="padding-left:4em;">Содержит путь доступа к подкаталогу 'files' в каталоге пакета в дереве портежей. Не изменяйте эту переменную.</p>


	<p><strong>EBUILD_PHASE</strong></p>


	<p style="padding-left:4em;">Contains the abreviated name of the phase function that is currently executing, such as "setup", "unpack", "compile", or "preinst".</p>


	<p><strong>EBUILD_PHASE_FUNC</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 5</strong> содержит полное имя выполняемой в данный момент фазовой функции, например, "pkg_setup", "src_unpack", "src_compile", "pkg_preinst".</p>


	<p><strong>EPREFIX</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 3</strong> для этой переменной определено смещение, для которого был конфигурирован данный portage в ходе установки. Смещение иногда необходимо в ебилдах и еклассах; в этом случае оно определяется как ${EPREFIX}. EPREFIX не содержит слэша, поэтому отсутствию смещения соответствует пустая строка. Не изменяйте эту переменную.</p>


	<p><strong>S</strong> = <em> ${WORKDIR}/${P}</em></p>


	<p style="padding-left:4em;">Содержит путь доступа к временному <em>каталогу сборки</em>. Эта переменная используется функциями <em>src_compile</em> и <em>src_install</em>. Обе они выполняются в каталоге <em>S</em>. Данная переменная может быть изменена, если необходимо указать другой каталог для распаковки архива пакета.</p>


	<p><strong>T</strong> = <em> ${PORTAGE_TMPDIR}/portage/${CATEGORY}/${PF}/temp</em></p>


	<p style="padding-left:4em;">Содержит путь доступа к <em>временному каталогу</em>. Может использоваться в любых целях.</p>


	<p><strong>D</strong> = <em> ${PORTAGE_TMPDIR}/portage/${CATEGORY}/${PF}/image/</em></p>


	<p style="padding-left:4em;">Содержит путь доступа к временному <em>каталогу для установки</em>. Каждая операция записи, выполняемая не через вспомогательные утилиты и функции (они описаны ниже), должна выполняться в каталоге ${D}. Начиная с <strong>EAPI 3</strong> здесь, как правило, приходится учитывать префикс смещения, для которого отведена переменная ${ED} (см.ниже). Не изменяйте эту переменную.</p>


	<p><strong>ED</strong> = <em> ${PORTAGE_TMPDIR}/portage/${CATEGORY}/${PF}/image/${EPREFIX}/</em></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 3</strong> для удобства содержит путь "${D%/}${EPREFIX}/". Для версий <strong>EAPI</strong> ниже <strong>EAPI 3</strong>, не поддерживающих <strong>${ED}</strong>, в тех случаях, когда в новых версиях используется <strong>${ED}</strong>, вспомогательные функции обращаются к <strong>${D}</strong>. Не изменяйте эту переменную.</p>


	<p><strong>MERGE_TYPE</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> переменная MERGE_TYPE может использоваться для запроса текущего типа установки. Для нее запустимы следующие значения:</p>


	<table style="margin-left:4em;;">
		<tr>
			<td>Значение</td>
			<td>Расшифровка</td>
		</tr>
		<tr>
			<td>binary</td>
			<td>прекомпилированный пакет назначен для установки</td>
		</tr>
		<tr>
			<td>buildonly</td>
			<td>пакет будет скомпилирован из исходного кода, но не назначен для установки</td>
		</tr>
		<tr>
			<td>source</td>
			<td>пакет будет скомпилирован из исходного кода и назначен для установки</td>
		</tr>
	</table>




	<p><strong>PORTAGE_LOG_FILE</strong></p>


	<p style="padding-left:4em;">Содержит путь доступа к журналу сборки. Если значение переменной <strong>PORT_LOGDIR</strong> не назначено, то <strong>PORTAGE_LOG_FILE</strong>=<strong>"${T}/build.log"</strong>.</p>


	<p><strong>REPLACED_BY_VERSION</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> переменная REPLACED_BY_VERSION может использоваться функциями pkg_prerm и pkg_postrm для запроса версии пакета, которая заменит текущую. Переменная пуста, если нет нового пакета; если же такой пакет имеется, переменная будет содержать только номер версии.</p>


	<p><strong>REPLACING_VERSIONS</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> переменная REPLACING_VERSIONS может использоваться pkg_pretend, pkg_setup, pkg_preinst и pkg_postinst для запроса версии (версий) пакета, которую (которые) заменит данный пакет. Переменная пуста, если нет пакетов, которые подлежат замене; если есть хотя бы один такой пакет, переменная содержит, через пробел, номера версии (версий) пакета, которые будет/-ут заменена/-ы. Как правило, эта переменная не содержит более одной версии, хотя, согласно PMS, может содержать несколько их.</p>


	<p><strong>ROOT</strong> = <em> /</em></p>


	<p style="padding-left:4em;">Содержит путь, по которому portage обращается к корневому каталогу текущей файловой системы. Когда пакеты вносят изменения в эту файловую систему, они должны использовать для этого дерево с префиксом ${ROOT}. Часто при этом необходимо учитывать префикс смещения, за который отвечает переменная ${EROOT} (см. ниже). Не изменяйте эту переменную.</p>


	<p><strong>EROOT</strong> = <em> ${ROOT%/}${EPREFIX}/</em></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 3</strong> для удобства содержит "${ROOT%/}${EPREFIX}/". Не изменяйте эту переменную.</p>


	<p><strong>DESCRIPTION</strong> = <em> A happy little package</em></p>


	<p style="padding-left:4em;">Содержит краткое описание пакета.</p>


	<p><strong>EAPI</strong> = <em> 0</em></p>


	<p style="padding-left:4em;">Определяет версию API ебилда, которой соответствует данный пакет. Если значение не определено, то по умолчанию выставляется "0". Если portage не распознал значение EAPI, пакет будет замаскирован и какие-либо операции над ним будут невозможны; в этом случае сначала необходимо обновить portage. Для максимальной обратной совместимости пакет должен соответствовать как можно более ранней версии EAPI. Обратите внимание, что использование команд <strong><a href="ebuild.html" class="wiki-page">ebuild</a></strong>(1) и <strong><a href=".html" class="wiki-page">repoman</a></strong>(1) с пакетом требует версии portage, которая умеет работать с соответствующей данному пакету версией EAPI.</p>


	<p><strong>SRC_URI</strong> = <em> http://example.com/path/${P}.tar.gz</em></p>


	<p style="padding-left:4em;">Содержит перечень URI необходимых файлов исходного кода. Одному файлу при этом могут соответствовать несколько URI. Список обрабатывается в порядке следования элементов: если элемент не удается найти ни на одном из зеркал _GENTOO_MIRRORS, система переходит к следующему элементу. Начиная с <strong>EAPI 2</strong> имя файла вывода определенного URI может быть изменено по вашему желанию: для этого справа ставится оператор "->" и, вслед за ним, имя файла вывода, какое вы предпочитаете. Все элементы, в частности, оператор и имя файла вывода, разделяются пробелом.</p>


	<p><strong>HOMEPAGE</strong> = <em> http://example.com/</em></p>


	<p style="padding-left:4em;">Эта переменная должна содержать URI основных сайтов, с которых берутся исходные коды, и другую дополнительную информацию, в зависимости от пакета.</p>


	<p><strong>KEYWORDS</strong> = <em>[-~][x86,ppc,sparc,mips,alpha,arm,hppa]</em></p>


	<p style="padding-left:4em;">Эта переменная должна содержать корректный список архитектур, под которыми работает/не работает ебилд. По умолчанию, если неизвестно, требует ли ебилд определенной архитектуры, соответствующее значение KEYWORD просто не указывается. Если известно, что ебилд не работает под той или иной архитектурой, укажите ее с минусом, например, -ppc. Если ебилд посылается для включения в дерево, он должен иметь ключ ~arch для архитектур, на которых он ПРЕДПОЛОЖИТЕЛЬНО РАБОТАЕТ.  (Чтобы размаскировать для тестирования пакеты, помеченные такими ключевыми словами, укажите ACCEPT_KEYWORDS="~arch" в командной строке или непосредственно в файле <strong><a href=".html" class="wiki-page">make.conf</a></strong>(5)) Полный список архитектур см. в /usr/portage/profiles/arch.list. Старайтесь соблюдать алфавитный порядок списка.</p>


	<p><strong>SLOT</strong></p>


	<p style="padding-left:4em;">Устанавливает слот для пакетов, для работы которых может понадобиться сосуществование несколько версий.  Значение по умолчанию - <strong>SLOT</strong>="0".  Если вы не вполне уверены в своих действиях, не пытайтесь экспериментировать с этой переменной.  В любом случае, ее значение <em>НИКОГДА</em> не должно оставаться неопределенным.</p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 5</strong> переменная SLOT может опционально содержать подслот; он указывается вслед за слотом, от которого отделяется слэшем /. Подслот должен представлять собой корректное имя слота. Подслоты используются в тех случаях, когда обновление пакета до новой версии с другим подслотом может потребовать пересборки пакетов-зависимостей. Если подслот в переменной SLOT не определён, подразумевается, что пакет имеет подслот, совпадающий с основным слотом. Подробнее об использовании подслотов см. в разделе <strong>Операторы атомов слотов</strong>.</p>


	<p><strong>LICENSE</strong></p>


	<p style="padding-left:4em;">Представляет собой перечень, через пробел, лицензий, под которые подпадает пакет. Этот список <strong>должен</strong> соответствовать содержимому /usr/portage/licenses/. Если той или иной лицензии нет в portage, следует добавить ее явно.</p>


	<p><strong>IUSE</strong></p>


	<p style="padding-left:4em;">Представляет собой практически исчерпывающий список USE-флагов, которые используются в вашем сценарии ebuild. Здесь не фигурируют только те USE-флаги, которые описывают архитектуру (см. <strong>KEYWORDS</strong>). Начиная с <strong>EAPI 1</strong> можно создавать настройки по умолчанию, включая или отключая <strong>USE</strong> -флаги путем выставления перед именами флагов соответственно + и - . Более подробно о порядке помещения в стек <strong>USE</strong> -флагов см. в разделе, посвященном переменной <strong>USE_ORDER</strong> в <strong><a href=".html" class="wiki-page">make.conf</a></strong>(5). С учетом значения по умолчанию <strong>USE_ORDER</strong>, отрицательные настройки IUSE по умолчанию действуют на USE только на уровне репозитория, поскольку параметры профиля и пользовательские настройки имеют над ними приоритет.</p>


	<p><strong>DEPEND</strong></p>


	<p style="padding-left:4em;">Данная переменная должна содержать перечень пакетов, необходимых программе для компиляции (они же сборочные зависимости).  Как правило, это библиотеки и заголовки.</p>


	<p style="padding-left:4em;">Начиная с экспериментального <strong>EAPI 5-hdepend</strong> список утилит следует хранить не здесь, а в переменной <strong>HDEPEND</strong>, поскольку пакеты <strong>DEPEND</strong> будут установлены в каталог <em>цели</em>, а значит, не смогут выполняться при перекрёстной компиляции (подробнее см. в разделе <strong>Перекрёстная компиляция</strong>).</p>


	<p style="padding-left:4em;">Здесь вы можете использовать синтаксис, описанный в разделе <strong>Зависимости</strong>.</p>


	<p><strong>RDEPEND</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать перечень всех пакетов, необходимых для работы данной программы (они же сборочные зависимости). Как правило, это библиотеки.</p>


	<p style="padding-left:4em;"> <strong>EAPI</strong> 3 и ниже, если она не определена, по умолчанию будет использовано значение переменной <strong>DEPEND</strong>. В <strong>EAPI</strong> 4 и выше переменная <strong>RDEPEND</strong> никогда не задается явно.</p>


	<p style="padding-left:4em;">Здесь вы можете использовать синтаксис, аналогичный описанному выше в разделе <strong>Зависимости</strong>.</p>


	<p><strong>HDEPEND</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать перечень всех пакетов, которые должны быть доступны как исполняемые при сборке данной программы (они же сборочные зависимости). Как правило, это утилиты: интерпретаторы или (кросс-)компиляторы.</p>


	<p style="padding-left:4em;">Эта переменная была введена в экспериментальном <strong>EAPI 5-hdepend</strong> и будет установлена в каталог <em>хоста</em> (подробнее см. в разделе <strong>Перекрёстная компиляция</strong>).</p>


	<p style="padding-left:4em;">Здесь вы можете использовать синтаксис, аналогичный описанному выше в разделе <strong>Зависимости</strong>.</p>


	<p><strong>PDEPEND</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать перечень всех пакетов, которые следует установить после установки данного пакета (постсборочные зависимости), но фактически они могут быть установлены раньше.</p>


	<p style="padding-left:4em;"><strong>***ВНИМАНИЕ***</strong> <br />Используйте эту возможность только в крайнем случае для прерывания циклических зависимостей!</p>


	<p style="padding-left:4em;">Здесь вы можете использовать синтаксис, аналогичный описанному выше в разделе <strong>Зависимости</strong>.</p>


	<p><strong>REQUIRED_USE</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> используется переменная <strong>REQUIRED_USE</strong>, позволяющая указывать допустимые и недопустимые комбинации <strong>USE-</strong> флагов. При необходимости можно использовать вложения.</p>


	<table style="margin-left:4em;;">
		<tr>
			<td>Действие</td>
			<td>Выражение</td>
		</tr>
		<tr>
			<td>Если флаг1 включен, то флаг2 отключен</td>
			<td>флаг1? ( !флаг2 )</td>
		</tr>
		<tr>
			<td>Если флаг1 включен, то флаг2 включен</td>
			<td>флаг1? ( флаг2 )</td>
		</tr>
		<tr>
			<td>Если флаг1 отключен, то флаг2 включен</td>
			<td>!флаг1? ( флаг2 )</td>
		</tr>
		<tr>
			<td>Если флаг1 отключен, то флаг2 отключен</td>
			<td>!флаг1? ( !флаг2 )</td>
		</tr>
		<tr>
			<td>Следует включить любой из флагов (включающее ИЛИ)</td>
			<td>|| ( флаг1 флаг2 флаг3 )</td>
		</tr>
		<tr>
			<td>Следует включить только один определенный флаг (исключающее ИЛИ)</td>
			<td>^^ ( флаг1 флаг2 флаг3 )</td>
		</tr>
		<tr>
			<td>(Начиная с EAPI 5:) Можно включить в крайнем случае один определённый флаг</td>
			<td>?? ( флаг1 флаг2 флаг3 )</td>
		</tr>
	</table>




	<p><strong>RESTRICT</strong> = <em>[strip,mirror,fetch,userpriv]</em></p>


	<p style="padding-left:4em;">Задает ограничения возможностей системы портежей, через пробел. Для задания динамических ограничений можно использовать условные конструкции, аналогичные описанным выше для переменной <strong>DEPEND</strong>.</p>


	<p style="padding-left:4em;"><em>binchecks</em></p>


	<p style="padding-left:8em;">Отключает проверку бинарных файлов. Используйте это значение ТОЛЬКО в том случае, если такая проверка не имеет смысла (например, для оригинальных заголовков и исходных кодов ядра, которые не имеют бинарных версий). Если опрос бинарных файлов следует пропустить по другим причинам (например, если речь идет о проприетарных бинарных компонентах), см. подробнее в разделе <strong>УПРАВЛЯЮЩИЕ QA-ПЕРЕМЕННЫЕ</strong>.</p>


	<p style="padding-left:4em;"><em>bindist</em></p>


	<p style="padding-left:8em;">Ограничение по собранным пакетам.</p>


	<p style="padding-left:4em;"><em>fetch</em></p>


	<p style="padding-left:8em;">Аналогично <em>mirror</em>, но файлы не будут выбираться и через переменную <strong>SRC_URI</strong>.</p>


	<p style="padding-left:4em;"><em>installsources</em></p>


	<p style="padding-left:8em;">Отключает installsources для определенных пакетов. Предназначено для пакетов, имеющих бинарные файлы, которые не совместимы с debugedit.</p>


	<p style="padding-left:4em;"><em>mirror</em></p>


	<p style="padding-left:8em;">Файлы, указанные в переменной <strong>SRC_URI</strong>, не будут загружаться с зеркал <strong>GENTOO_MIRRORS</strong></p>


	<p style="padding-left:4em;"><em>primaryuri</em></p>


	<p style="padding-left:8em;">Файлы будут загружаться сначала с URI, указанных в переменной <strong>SRC_URI</strong>, и лишь потом с зеркал <strong>GENTOO_MIRRORS</strong>.</p>


	<p style="padding-left:4em;"><em>strip</em></p>


	<p style="padding-left:8em;">Из результирующих двоичных модулей/библиотек не будет удаляться отладочная информация.</p>


	<p style="padding-left:4em;"><em>test</em></p>


	<p style="padding-left:8em;">src_test не будет запускаться, даже если пользовательское значение <strong>FEATURES</strong>=test.</p>


	<p style="padding-left:4em;"><em>userpriv</em></p>


	<p style="padding-left:8em;">Отключает userpriv для определенных пакетов.</p>


	<p><strong>PROPERTIES</strong> = <em>[interactive]</em></p>


	<p style="padding-left:4em;">Список параметров через пробел; поддерживается синтаксис условных конструкций.</p>


	<p style="padding-left:4em;"><em>interactive</em></p>


	<p style="padding-left:8em;">На одной или нескольких фазах ебилда пользователю будет предложено ввести данные.</p>


	<p><strong>PROVIDE</strong> = <em>"virtual/ЦЕЛЬ"</em></p>


	<p style="padding-left:4em;">Эту переменную следует использовать, только если пакет имеет виртуальную цель. Например, blackdown-jdk и sun-jdk предоставляют virtual/jdk. Это позволяет пакетам задавать зависимости от virtual/jdk, а не явно от реализации blackdown или sun.</p>


	<p><strong>DOCS</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> эта переменная содержит массив или разделенный пробелами список документационных файлов для функции src_install по умолчанию для установки с помощью dodoc. Если она не определена, будет использован разумный список по умолчанию. См. ниже справку по src_install.</p>


	<h2 id="УПРАВЛЯЮЩИЕ-QA-ПЕРЕМЕННЫЕ">УПРАВЛЯЮЩИЕ QA-ПЕРЕМЕННЫЕ<a href="#УПРАВЛЯЮЩИЕ-QA-ПЕРЕМЕННЫЕ" class="wiki-anchor">&para;</a></h2>


	<p><strong>Замечания по синтаксису</strong></p>


	<p style="padding-left:4em;">Существует ряд QA-переменных, которые позволяют сценарию управлять некоторыми QA-тестами, выполняемыми portage. В ебилдах к ним следует прибегать как можно реже, поскольку в противном случае теряет смысл сам контроль качества. QA-переменные предназначены прежде всего для сценариев, которые устанавливают бинарные объекты из закрытых исходных кодов, которые не могут быть изменены.</p>


	<p style="padding-left:4em;">Обратите внимание, что объекты, которые не соответствуют данным правилам, могут выдавать ошибку на некоторых архитектурах.</p>


	<p><strong>QA_PREBUILT</strong></p>


	<p style="padding-left:4em;">Содержит перечень путей доступа к прекомпилированным, бинарным файлам в каталоге образа. Указанные здесь пути добавляются к каждой из перечисленных ниже переменных QA_<strong>. Пути могут включать fnmatch-подобные шаблоны, которые встроенными средствами переводятся в регулярные выражения для переменных QA_</strong>: последние не поддерживают такие шаблоны, а регулярные выражения - поддерживают. Переводчик просто заменяет "*" на ".*".</p>


	<p><strong>QA_TEXTRELS</strong></p>


	<p style="padding-left:4em;">Может содержать перечень путей доступа к файлам в каталоге образа, которые содержат неустранимые text relocation. Пути могут включать шаблоны fnmatch.</p>


	<p style="padding-left:4em;">Эта переменная предназначена для использования с бинарными объектами, установленными из закрытых исходных кодов, которые не могут быть изменены.</p>


	<p><strong>QA_EXECSTACK</strong></p>


	<p style="padding-left:4em;">Содержит список путей доступа к объектам в каталоге образа, которые для запуска требуют исполняемый стек. Пути могут включать шаблоны fnmatch.</p>


	<p style="padding-left:4em;">Эта переменная предназначена для использования с объектами, которым действительно нужен исполняемый стек (а не с теми, которые лишь маркированы соответствующим образом).</p>


	<p><strong>QA_WX_LOAD</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать список путей доступа к файлам в каталоге образа, которые содержат перезаписываемые и исполняемые сегменты - что случается редко. Пути могут содержать шаблоны fnmatch.</p>


	<p><strong>QA_FLAGS_IGNORED</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать список путей доступа к файлам в каталоге образа, которые не содержат .GCC.command.line-секции или содержат .hash-секции. Пути могут содержать регулярные выражения с экранированными символами, заключенными в управляющие кавычки.</p>


	<p style="padding-left:4em;">Переменная предназначена для использования с файлами бинарных пакетов, которые игнорируют переменные CFLAGS, CXXFLAGS, FFLAGS, FCFLAGS, LDFLAGS.</p>


	<p><strong>QA_MULTILIB_PATHS</strong></p>


	<p style="padding-left:4em;">Эта переменная содержит список путей доступа к файлам в каталоге образа, которые должны быть проигнорированы при проверках multilib-strict. Пути могут содержать регулярные выражения с экранированными символами, заключенными в управляющие кавычки.</p>


	<p><strong>QA_PRESTRIPPED</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать список путей доступа к бинарным файлам в каталоге образа, не содержащим отладочной информации. Пути могут включать регулярные выражения с экранированными символами, заключенными в управляющие кавычки.</p>


	<p><strong>QA_SONAME</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать список путей доступа к файлам общедоступных библиотек в каталоге образа, не имеющих SONAME. Пути могут включать регулярные выражения с экранированными символами, заключенными в управляющие кавычки.</p>


	<p><strong>QA_SONAME_NO_SYMLINK</strong></p>


	<p style="padding-left:4em;"> Эта переменная должна содержать список путей доступа к файлам общедоступных библиотек в каталоге образа, имеющим SONAME, но символической ссылки на SONAME в том же каталоге быть не должно. Пути могут включать регулярные выражения с экранированными символами, заключенными в управляющие кавычки.</p>


	<p><strong>QA_DT_NEEDED</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать список путей доступа к файлам общедоступных библиотек в каталоге образа, не имеющим записей NEEDED.  Пути могут включать регулярные выражения с экранированными символами, заключенными в управляющие кавычки.</p>


	<p><strong>QA_DESKTOP_FILE</strong></p>


	<p style="padding-left:4em;">Эта переменная должна содержать список путей доступа к desktop-файлам в каталоге образа, которые не должны учитываться. Пути могут включать регулярные выражения с экранированными символами, заключенными в управляющие кавычки.</p>


	<h2 id="ОБЪЯВЛЕНИЯ-PORTAGE">ОБЪЯВЛЕНИЯ PORTAGE<a href="#ОБЪЯВЛЕНИЯ-PORTAGE" class="wiki-anchor">&para;</a></h2>


	<p><strong>inherit</strong></p>


	<p style="padding-left:4em;">Inherit обеспечивает поддержку в portage т.н. еклассов функций, внешних по отношению к ебилдам и обладающих наследуемыми методами и данными. Они определяют функции и устанавливают типы данных как drop-in-замены, расширенные, упрощенные подпрограммы для самых обычных задач, с целью упорядочения процесса сборки. Вызов inherit не может зависеть от условий, которые могут меняться в пределах одного ебилда. Спецификация еклассов содержит только их имена, без расширения <em>.eclass</em>. Обратите также внимание, что оператор inherit должен предшествовать объявлению других переменных, если только эти переменные не используются в глобальном контексте еклассов.</p>


	<h2 id="ФАЗОВЫЕ-ФУНКЦИИ">ФАЗОВЫЕ ФУНКЦИИ<a href="#ФАЗОВЫЕ-ФУНКЦИИ" class="wiki-anchor">&para;</a></h2>


	<p><strong>pkg_pretend</strong></p>


	<p style="padding-left:4em;">Эта функция может быть определена начиная с <strong>EAPI 4</strong>; она используется для проверки выполнения различных требований. Она должна вызываться как можно раньше, до того, как будет предпринята попытка удовлетворить зависимости. Если функция обнаружит проблему, она должна вызвать <strong>eerror</strong> и <strong>die</strong>. Окружение (переменные, функции, временные каталоги и т.д.), используемое для выполнения <strong>pkg_pretend</strong>, не сохраняется и, следовательно, не будет доступно на последующих фазах.</p>


	<p><strong>pkg_nofetch</strong></p>


	<p style="padding-left:4em;">Если в переменной <strong>RESTRICT</strong> указано <em>fetch</em>, эта функция будет запущена, если не удается найти файлы в <strong>SRC_URI</strong>. Таким образом удобно сообщать пользователю, <strong>как</strong> получить данные файлы. Достаточно выдать сообщение и нормально завершить работу функции; не завершайте ее вызовом <strong>die</strong>.</p>


	<p><strong>pkg_setup</strong></p>


	<p style="padding-left:4em;">Эта функция может использоваться в том случае, если пакету требуется особая настройка или проверка, прежде чем будут выполняться другие действия. <br />Исходный рабочий каталог ${PORTAGE_TMPDIR}.</p>


	<p><strong>src_unpack</strong></p>


	<p style="padding-left:4em;">Эта функция используется для распаковки всех исходных текстов, указанных в <em>A</em>, в каталог <em>WORKDIR</em>. Если эта функция в сценарии ebuild не определена, вызывается <em>unpack ${A}</em>. В этой функции производится наложение патчей и выполняются все остальные изменения, необходимые перед конфигурированием/компиляцией. <br />Исходный рабочий каталог $WORKDIR.</p>


	<p><strong>src_prepare</strong></p>


	<p style="padding-left:4em;">Все действия по подготовке исходного кода, в частности, наложение патчей, должны выполняться в этой функции. Она поддерживается в версиях EAPI начиная с <strong>EAPI 2</strong>.<br />Исходный рабочий каталог $S.</p>


	<p><strong>src_configure</strong></p>


	<p style="padding-left:4em;">Все необходимые действия по конфигурированию должны выполняться в этой функции. Она поддерживается в версиях EAPI начиная с <strong>EAPI 2</strong>. <br />Исходный рабочий каталог $S.</p>


	<p><strong>src_compile</strong></p>


	<p style="padding-left:4em;">В <strong>EAPI 2</strong> и ниже все необходимые шаги по конфигурированию и компиляции должны выполняться в этой функции; начиная с <strong>EAPI 2</strong> она отвечает лишь за компиляцию.<br />Исходный рабочий каталог $S.</p>


	<p><strong>src_test</strong></p>


	<p style="padding-left:4em;">Запускает все тест-кейсы, определенные для данного пакета. По умолчанию будет выполнено 'make check', а затем 'make test'. <br />Исходный рабочий каталог $S.</p>


	<p><strong>src_install</strong></p>


	<p style="padding-left:4em;">Должна содержать все необходимое для установки пакета во временном <em>каталоге установки</em>.<br />Исходный рабочий каталог $S.</p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong>, если  <em>src_install</em> не определена, используется следующее умолчание:</p>


<pre style="margin-left:4.0em;">
src_install() { 
    if [[ -f Makefile || -f GNUmakefile || -f makefile ]] ; then 
        emake DESTDIR="${D}" install 
    fi 

    if ! declare -p DOCS &#38;&gt;/dev/null ; then 
        local d 
        for d in README* ChangeLog AUTHORS NEWS TODO CHANGES \ 
                THANKS BUGS FAQ CREDITS CHANGELOG ; do 
            [[ -s "${d}" ]] &#38;&#38; dodoc "${d}" 
        done 
    elif [[ $(declare -p DOCS) == "declare -a "* ]] ; then 
        dodoc "${DOCS[@]}" 
    else 
        dodoc ${DOCS} 
    fi 
} 
</pre>

	<p><strong>pkg_preinst</strong> <strong>pkg_postinst</strong></p>


	<p style="padding-left:4em;">В этих функциях должны выполняться все модификации текущей файловой системы, необходимые до и после включения пакета в дерево. Здесь также необходимо помещать комментарий для пользователя, выводимый в конце выполнения функции.<br />Исходный рабочий каталог $PWD.</p>


	<p><strong>pkg_prerm</strong> <strong>pkg_postrm</strong></p>


	<p style="padding-left:4em;">Аналогично функциям pkg_*inst, но для исключения пакета из дерева.<br />Исходный рабочий каталог $PWD.</p>


	<p><strong>pkg_config</strong></p>


	<p style="padding-left:4em;">Эта функция должна содержать необязательные основные шаги по конфигурированию.<br />Исходный рабочий каталог $PWD.</p>


	<h2 id="ВСПОМОГАТЕЛЬНЫЕ-ФУНКЦИИ">ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ<a href="#ВСПОМОГАТЕЛЬНЫЕ-ФУНКЦИИ" class="wiki-anchor">&para;</a></h2>


	<h3 id="Фазы">Фазы<a href="#Фазы" class="wiki-anchor">&para;</a></h3>


	<p><strong>default</strong></p>


	<p style="padding-left:4em;">Вызывает фазовые функции по умолчанию для текущей фазы выполнения. Эта функция поддерживается начиная с <strong>EAPI 2</strong>.</p>


	<p><strong>default_*</strong></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 2</strong> функции pkg_nofetch и src_* с параметрами по умолчанию доступны через функцию с именем, начинающимся с default_ и заканчивающимся соответствующим именем фазовой функции. Например, вызвав функцию default_src_compile, вы фактически запускаете функцию src_compile с параметрами по умолчанию.</p>


	<table style="margin-left:4em;;">
		<tr>
			<td>Фазовые функции по умолчанию</td>
		</tr>
		<tr>
			<td>default_pkg_nofetch</td>
		</tr>
		<tr>
			<td>default_src_unpack</td>
		</tr>
		<tr>
			<td>default_src_prepare</td>
		</tr>
		<tr>
			<td>default_src_configure</td>
		</tr>
		<tr>
			<td>default_src_compile</td>
		</tr>
		<tr>
			<td>default_src_test</td>
		</tr>
	</table>




	<h3 id="Разное">Разное<a href="#Разное" class="wiki-anchor">&para;</a></h3>


	<p><strong>die</strong> <em>[причина]</em></p>


	<p style="padding-left:4em;">Вызывает прекращение работы текущего процесса emerge. Выводимая при этом информация будет включать <em>причину</em>.</p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> все вспомогательные функции автоматически вызывают <strong>die</strong> при любой ошибке. Вызывы вспомогательных функций могут иметь префиксом функцию <strong>nonfatal</strong>, дабы ошибки не рассматривались системой как фатальные.</p>


	<p><strong>nonfatal</strong> <em>&lt;вспомогательная функция&gt;</em></p>


	<p style="padding-left:4em;">Выполняет <em>вспомогательную функцию</em>, но в случае ошибки <em>не вызывает</em> <strong>die</strong>. Функция <strong>nonfatal</strong> доступна начиная с <strong>EAPI 4</strong>.</p>


	<p><strong>use</strong> <em>&lt;элемент USE&gt;</em></p>


	<p style="padding-left:4em;">Если <em>элемент USE</em> указан в переменной <strong>USE</strong>, функция без дополнительных сообщений возвращает 0 ("истинно"). Если же <em>элемент USE</em> в переменной <strong>USE</strong> не указан, функция без дополнительных сообщений возвращает 1 ("ложно"). Если вам нужен подробный вывод <strong>use</strong>, используйте вспомогательную функцию <strong>usev</strong>.</p>


	<p style="padding-left:4em;"><em>Пример:</em></p>


<pre style="margin-left:8.0em;">
if use gnome ; then 
    guiconf="--enable-gui=gnome --with-x" 
elif use gtk ; then 
    guiconf="--enable-gui=gtk --with-x" 
elif use X ; then 
    guiconf="--enable-gui=athena --with-x" 
else 
    # gui-версия собираться не будет 
    guiconf="" 
fi 
</pre>

	<p><strong>usex</strong> <em>&lt;USE-флаг&gt;</em> <em>[вывод, если истинно]</em> <em>[вывод, если ложно]</em> <em>[суффикс, если истинно]</em> <em>[суффикс, если ложно]</em></p>


	<p style="padding-left:4em;">Если USE-флаг установлен, то будет выполнено echo [true output][true suffix] (по умолчанию "yes"), иначе echo [false output][false suffix] (по умолчанию "no"). Функция <strong>usex</strong> доступна начиная с <strong>EAPI 5</strong>.</p>


	<p><strong>use_with</strong> <em>&lt;элемент USE&gt;</em> <em>[имя configure]</em> <em>[опция configure]</em></p>


	<p style="padding-left:4em;">Эта функция удобна для создания специфических опций, передаваемых сценарию configure. Если <em>элемент USE</em> указан в переменной <strong>USE</strong>, будет выведена строка <em>--with-[имя configure]=[опция configure]</em>. Если <em>опция configure</em> не указана, будет выведено только <em>--with-[имя configure]</em>.  Если <em>элемент USE</em> не указан в переменной <strong>USE</strong>, будет выведена строка <em>--without-[имя configure]</em>. Если <em>имя configure</em> не указано, вместо него будет использоваться <em>элемент USE</em>. Начиная с <strong>EAPI 4</strong> добавлено распознавание пустого аргумента <em>опция configure</em>. В <strong>EAPI 3</strong> и ниже пустая <em>опция configure</em> обрабатывается так, как если бы она не была указана.</p>


	<p style="padding-left:4em;"><em>Примеры:</em></p>


<pre style="margin-left:8.0em;">
USE="opengl" 
myconf=$(use_with opengl) 
(новое значение myconf - "--with-opengl") 

USE="jpeg" 
myconf=$(use_with jpeg libjpeg) 
(новое значение myconf - "--with-libjpeg") 

USE="" 
myconf=$(use_with jpeg libjpeg) 
(новое значение myconf - "--without-libjpeg") 

USE="sdl" 
myconf=$(use_with sdl SDL all-plugins) 
(новое значение myconf - "--with-SDL=all-plugins") 
</pre>

	<p><strong>use_enable</strong> <em>&lt;USE&gt;</em> <em>[имя configure]</em> <em>[опция configure]</em></p>


	<p style="padding-left:4em;">Аналогична описанной выше <strong>use_with</strong>, но с опциями configure <em>--enable-</em> вместо <em>--with-</em> и <em>--disable-</em> вместо <em>--without-</em>. Начиная с <strong>EAPI 4</strong> добавлено распознавание пустого аргумента <em>опция configure</em>. В <strong>EAPI 3</strong> и ниже пустая <em>опция configure</em> обрабатывается так, как если бы она не была указана.</p>


	<p><strong>hasv</strong> <em>&lt;элемент&gt;</em> <em>&lt;список элементов&gt;</em></p>


	<p style="padding-left:4em;">Если <em>элемент</em> входит в <em>список элементов</em>, он выводится и функция <strong>hasv</strong> возвращает 0; в противном случае не выводится ничего, а функция возвращает 1. Как говорилось выше для use, существует версия этой фукции, которая ничего не выводит, <strong>has</strong>. Используйте <strong>has</strong> во всех случаях, когда вывод информации не нужен. В частности, никогда не используйте вывод для вычислений. <br />Разделитель <em>списка элементов</em> определяется переменной <em>IFS</em>.  По умолчанию значение этой переменной - ' ' или пробел. Это переменная <strong>bash</strong>(1).</p>


	<p><strong>has_version</strong> <em>&lt;категория/пакет-версия&gt;</em></p>


	<p style="padding-left:4em;">Проверяет, установлен ли в системе пакет <em>категория/пакет-версия</em>. Параметр может принимать любые значения, допустимые для переменной <strong>DEPEND</strong>.  Функция возвращает 0 если пакет, указанный аргументом, установлен, иначе возвращает 1. Начиная с <strong>EAPI 5</strong> здесь можно использовать опцию --host-root, чтобы запрос относился к корню хоста вместо ${ROOT}.</p>


	<p><strong>best_version</strong> <em>&lt;пакет&gt;</em></p>


	<p style="padding-left:4em;">Эта функция ищет <em>пакет</em> в текущей базе данных установленных программ и выдает "лучшую версию" устанавливаемого пакета.Начиная с <strong>EAPI 5</strong> здесь можно использовать опцию --host-root, чтобы запрос относился к корню хоста вместо ${ROOT}.</p>


	<p style="padding-left:4em;"><em>Пример:</em></p>


	<p style="padding-left:8em;">VERINS="$(best_version net-ftp/glftpd)" <br />(теперь VERINS имеет значение "net-ftp/glftpd-1.27", если установлен glftpd-1.27)</p>


	<h3 id="Ловушки">Ловушки<a href="#Ловушки" class="wiki-anchor">&para;</a></h3>


	<p><strong>register_die_hook</strong> <em>[имена функций]</em></p>


	<p style="padding-left:4em;">Привязывает вызов одной или более функций к ошибке ебилда, в том числе в случае конфликта с другими пакетами.</p>


	<p><strong>register_success_hook</strong> <em>[имена функций]</em></p>


	<p style="padding-left:4em;">Привязывает вызов одной или более функций к успешной сборке и/или установке ебилда.</p>


	<h3 id="Вывод">Вывод<a href="#Вывод" class="wiki-anchor">&para;</a></h3>


	<p><strong>einfo</strong> <em>"текущее сообщение"</em></p>


	<p style="padding-left:4em;">Функция аналогична <strong>elog</strong>, но должна использоваться применительно к сообщениям, не критичным для пользователя (таким как сообщение о ходе сборки или вывод состояния операции).</p>


	<p><strong>elog</strong> <em>"важная информация"</em></p>


	<p style="padding-left:4em;">Если необходимо вывести важное сообщение, которое пользователь обязательно должен прочитать, используйте функцию <strong>elog</strong>. Она работает так же, как <strong>echo</strong>(1), но предоставляет более подробный вывод, привлекающий внимание пользователя. Кроме того, portage внесет данное сообщение в журнал, чтобы можно было к нему вернуться.</p>


	<p><strong>ewarn</strong> <em>"предупреждение"</em></p>


	<p style="padding-left:4em;">Аналогична <strong>einfo</strong>, но должна использоваться для вывода пользователю предупреждающих сообщений.</p>


	<p><strong>eqawarn</strong> <em>"предупреждение QA"</em></p>


	<p style="padding-left:4em;">Аналогична <strong>einfo</strong>, но должна использоваться для вывода пользователю предупреждающих сообщений по QA.</p>


	<p><strong>eerror</strong> <em>"сообщение об ошибке"</em></p>


	<p style="padding-left:4em;">Аналогична <strong>einfo</strong>, но должна использоваться для вывода пользователю сообщений об ошибках.</p>


	<p><strong>ebegin</strong> <em>"полезное сообщение"</em></p>


	<p style="padding-left:4em;">Аналогично функции <strong>einfo</strong>, выводит <em>полезное сообщение</em> и сообщает о том, что выполнение последующей операции может занять некоторое время. По завершении должна вызываться функция <strong>eend</strong>.</p>


	<p><strong>eend</strong> <em>&lt;состояние&gt;</em> <em>["сообщение об ошибке"]</em></p>


	<p style="padding-left:4em;">После того, как отработала функция <strong>ebegin</strong>, выводит сообщение, маркированное либо "OK" (при успешном завершении), либо "!!" (в случае ошибки).  Если <em>состояние</em> не равно нулю, будет выведено дополнительное <em>сообщение об ошибке</em>.</p>


	<h3 id="Распаковка">Распаковка<a href="#Распаковка" class="wiki-anchor">&para;</a></h3>


	<p><strong>unpack</strong> <em>&lt;исходный код&gt;</em> <em>[другие исходные коды]</em></p>


	<p style="padding-left:4em;">Эта функция распаковывает и/или разархивирует <em>исходный код</em> в текущий каталог. Он будет добавлен в переменную <strong>DISTDIR</strong>.</p>


	<h3 id="Компиляция">Компиляция<a href="#Компиляция" class="wiki-anchor">&para;</a></h3>


	<p><strong>econf</strong> <em>[опции configure]</em></p>


	<p style="padding-left:4em;">Эта функция используется вместо configure. Она выполняет следующее: <br /><pre style="margin-left:4.0em;">
${ECONF_SOURCE:-.}/configure \ 
    ${CBUILD:+--build=${CBUILD}} \ 
    --datadir="${EPREFIX}"/usr/share \ 
    --host=${CHOST} \ 
    --infodir="${EPREFIX}"/usr/share/info \ 
    --localstatedir="${EPREFIX}"/var/lib \ 
    --prefix="${EPREFIX}"/usr \ 
    --mandir="${EPREFIX}"/usr/share/man \ 
    --sysconfdir="${EPREFIX}"/etc \ 
    ${CTARGET:+--target=${CTARGET}} \ 
    --disable-dependency-tracking \ 
    ${EXTRA_ECONF} \ 
    опции configure || die "econf failed" 
</pre></p>


	<p style="padding-left:4em;">Обратите внимание, что переменная <em>EXTRA_ECONF</em> отведена для пользователей и не предназначена для написания ebuild-сценариев. Если небходимо передать configure дополнительные опции, делайте это с помощью <strong>econf</strong>. Заметьте также, что, если сценарий configure выдает ошибку, <strong>econf</strong> автоматически вызывает функцию <strong>die</strong>. Начиная с <strong>EAPI 3</strong> функция <strong>econf</strong> обращается к переменной <strong>${EPREFIX}</strong>, которая в предыдущих версиях <strong>EAPI</strong> не использовалась, а начиная с <strong>EAPI 4</strong> - добавляет <em>--disable-dependency-tracking</em> к аргументам, если в выводе команды <em>configure --help</em> встречается строка <em>disable-dependency-tracking</em>. Начиная с <strong>EAPI 5</strong>, <strong>econf</strong> добавляет к аргументам <em>disable-silent-rules</em>, если в  выводе <em>configure --help</em> встречается строка_disable-silent-rules_.</p>


	<p><strong>emake</strong> <em>[опции make]</em></p>


	<p style="padding-left:4em;">Эта функция используется вместо make.  Она выполняет 'make ${MAKEOPTS} <em>опции make</em>' (согласно настройкам в make.globals); по умолчанию выставлено MAKEOPTS="-j2".</p>


	<p style="padding-left:4em;"><strong>***ВНИМАНИЕ***</strong> <br />Прежде чем использовать <strong>emake</strong>, убедитесь, что сборка возможна при распараллеливании (make -j2).  Важно знать это наверняка, поскольку распараллеливание хотя и не всегда, но <em>может</em> приводить к ошибкам. Если при параллельной сборке пакет выдает ошибку, которую не удается разрешить, вместо 'make' воспользуйтесь '<strong>emake</strong> -j1'.</p>


	<h3 id="Установка">Установка<a href="#Установка" class="wiki-anchor">&para;</a></h3>


	<p><strong>einstall</strong> <em>[опции make]</em></p>


	<p style="padding-left:4em;">Эта функция используется вместо make install.  Она выполняет следующее: <br /><pre style="margin-left:4.0em;">
make \ 
    prefix=${ED}/usr \ 
    datadir=${ED}/usr/share \ 
    infodir=${ED}/usr/share/info \ 
    localstatedir=${ED}/var/lib \ 
    mandir=${ED}/usr/share/man \ 
    sysconfdir=${ED}/etc \ 
    ${EXTRA_EINSTALL} \ 
    опции make \ 
    install 
</pre></p>


	<p style="padding-left:4em;"><strong>Не используйте</strong> эту функцию вместо 'emake install DESTDIR=${D}': данный способ установки предназначен преимущественно для пакетов, собираемых с помощью make. Не используйте также переменную <em>EXTRA_EINSTALL</em>, так как она зарезервирована для пользователей.</p>


	<p><strong>prepall</strong></p>


	<p><strong>prepalldocs</strong></p>


	<p><strong>prepallinfo</strong></p>


	<p><strong>prepallman</strong></p>


	<p><strong>prepallstrip</strong></p>


	<p style="padding-left:4em;">Эти функции удобны в случае, когда пакет устанавливается в каталог <strong>${D}</strong> с помощью сценариев (например, make-файлов). Если необходимо гарантировать, что библиотеки являются выполняемыми, файлы aclocal установлены правильно, все файлы doc/info/man упакованы, из выполняемых файлов удалена отладочная информация, используйте этот набор функций.</p>


	<p style="padding-left:4em;"><strong>prepall:</strong></p>


	<p style="padding-left:8em;">Запускает функции <strong>prepallman</strong>, <strong>prepallinfo</strong>, <strong>prepallstrip</strong>, устанавливает для библиотек права +x, а затем проверяет каталоги aclocal.<br />Обратите внимание, что функция <strong>prepalldocs</strong> при этом <em>*не вызывается*</em>.</p>


	<p style="padding-left:4em;"><strong>prepalldocs:</strong></p>


	<p style="padding-left:8em;">Упаковывает все doc-файлы в каталоге ${ED}/usr/share/doc.</p>


	<p style="padding-left:4em;"><strong>prepallinfo:</strong></p>


	<p style="padding-left:8em;">Упаковывает все info-файлы в каталоге ${ED}/usr/share/info.</p>


	<p style="padding-left:4em;"><strong>prepallman:</strong></p>


	<p style="padding-left:8em;">Упаковывает все man-файлы в каталоге ${ED}/usr/share/man.</p>


	<p style="padding-left:4em;"><strong>prepallstrip:</strong></p>


	<p style="padding-left:8em;">Удаляет отладочную инфомацию из всех выполняемых файлов - в частности, из библиотек.</p>


	<p><strong>prepinfo</strong> <em>[каталог]</em></p>


	<p><strong>prepman</strong> <em>[каталог]</em></p>


	<p><strong>prepstrip</strong> <em>[каталог]</em></p>


	<p style="padding-left:4em;">Аналогична функциям <strong>prepall</strong>, но с небольшими различиями.</p>


	<p style="padding-left:4em;"><strong>prepinfo:</strong></p>


	<p style="padding-left:8em;">Если <em>каталог</em> не указан аргументом, то <strong>prepinfo</strong> принимает за каталог <em>usr</em>. Затем <strong>prepinfo</strong> упакует все файлы в каталоге ${ED}/<em>dir</em>/info.</p>


	<p style="padding-left:4em;"><strong>prepman:</strong></p>


	<p style="padding-left:8em;">Если <em>каталог</em> не указан аргументом, то <strong>prepman</strong> принимает за каталог <em>usr</em>. Затем <strong>prepman</strong> упакует все файлы в каталоге ${ED}/<em>dir</em>/man/*/.</p>


	<p style="padding-left:4em;"><strong>prepstrip:</strong></p>


	<p style="padding-left:8em;">Из всех файлов в каталоге ${ED}/<em>dir</em> удаляется отладочная информация. Можно указывать несколько каталогов.</p>


	<p><strong>docompress</strong> <em lang="-x"> &lt;путь&gt; [другие пути]</em></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> вспомогательная функция <strong>docompress</strong> используется для управления списками файлов на включение или исключение для необязательной упаковки. Если первый аргумент - <strong>-x</strong>, каждый из последующих аргументов будет добавлен в список на исключение. Без -x все аргументы будут добавлены в список на включение. Изначально список на включение содержит каталоги <em>/usr/share/doc</em>, <em>/usr/share/info</em>, and <em>/usr/share/man</em>. Изначальный список на исключение содержит каталог_/usr/share/doc/${PF}/html_.</p>


	<p style="padding-left:4em;">Необязательная упаковка выполняется после того, как отработала функция <strong>src_install</strong>, но до того, как начнет выполняться любая последующая фазовая функция. Для каждого элемента списка на включение временно принимается префиксом значение переменной <strong>D</strong>. Далее:</p>


	<p style="padding-left:8em;">Если это директория, система будет действовать так, как если бы каждый файл или каталог, находящийся непосредственно в этой директории, состоял в списке на включение.</p>


	<p style="padding-left:8em;">Если это файл, он может быть упакован, если только он не был исключен (см. ниже).</p>


	<p style="padding-left:8em;">Если элемент не существует, он будет проигнорирован.</p>


	<p style="padding-left:4em;">Подлежит ли элемент исключению, определяется следующим образом: для каждого элемента списка на исключение временно принимается префиксом значение переменной <strong>D</strong>. Далее:</p>


	<p style="padding-left:8em;">Если это директория, система будет действовать так, как если бы каждый файл или каталог, находящийся непосредственно в данном каталоге, состоял в списке на исключение.</p>


	<p style="padding-left:8em;">Если это файл, он не будет упакован.</p>


	<p style="padding-left:8em;">Если элемент не существует, то он будет проигнорирован.</p>


	<p><strong>dosed</strong> <em>"s:orig:change:g" &lt;имя файла&gt;</em></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong>, вспомогательная функция <strong>dosed</strong> не существует. Ебилды должны вызывать команду <strong>sed(1)</strong> напрямую (принимая, что это sed GNU).</p>


	<p style="padding-left:4em;">Выполняет команду sed для файла <em>имя файла</em> в каталоге ${ED}. Если никакого выражения не задано, то <em>"s:${D}::g"</em> выступает как выражение по умолчанию. Обратите внимание, что для этого выражения <strong>НЕ ИСПОЛЬЗУЕТСЯ</strong> префикс смещения. <br /><strong>'dosed\</strong> <strong>s:/usr/local:/usr:g</strong> <strong>\</strong> <strong>/usr/bin/some-script'</strong> выполняет команду для файла ${ED}/usr/bin/сценарий.</p>


	<p><strong>dodir</strong> <em>&lt;путь&gt;</em></p>


	<p style="padding-left:4em;">Создает каталог в ${ED}. <br /><strong>'dodir\</strong> <strong>/usr/lib/apache'</strong> создает ${ED}/usr/lib/apache.  Обратите внимание, что функции do* будут вызывать функцию <strong>dodir</strong>.</p>


	<p><strong>diropts</strong> <em>[опции для install(1)]</em></p>


	<p style="padding-left:4em;">Может использоваться для задания опций утилиты install, к которым обращается функция <strong>dodir</strong>.  Значение по умолчанию - <em>-m0755</em>.</p>


	<p><strong>into</strong> <em>&lt;путь&gt;</em></p>


	<p style="padding-left:4em;">Назначает корневой каталог (<em>DESTTREE</em>) для других функций, таких как <strong>dobin</strong>, <strong>dosbin</strong>, <strong>doman</strong>, <strong>doinfo</strong>, <strong>dolib</strong>. <br />Корневой каталог по умолчанию - /usr.</p>


	<p><strong>keepdir</strong> <em>&lt;путь&gt;</em></p>


	<p style="padding-left:4em;">Заставляет portage оставить каталог, даже если он пуст. Работает аналогично функции <strong>dodir</strong>.</p>


	<p><strong>dobin</strong> <em>&lt;бинарный файл&gt; [другие бинарные файлы]</em></p>


	<p style="padding-left:4em;">Устанавливает один или несколько <em>бинарных файлов</em> в каталог <em>DESTTREE</em>/bin. Функция создает все необходимые каталоги.</p>


	<p><strong>dosbin</strong> <em>&lt;бинарный файл&gt; [другие бинарные файлы]</em></p>


	<p style="padding-left:4em;">Устанавливает один или несколько <em>бинарных файлов</em> в каталог <em>DESTTREE</em>/sbin. Функция создает все необходимые каталоги.</p>


	<p><strong>doinitd</strong> <em>&lt;сценарий init.d&gt; [другие сценарии init.d]</em></p>


	<p style="padding-left:4em;">Устанавливает сценарии <em>init.d</em> для Gentoo по стандартному для init.d пути (/etc/init.d/). Функция создает все необходимые каталоги.</p>


	<p><strong>doconfd</strong> <em>&lt;файл conf.d&gt; [другие файлы conf.d]</em></p>


	<p style="padding-left:4em;">Устанавливает файлы <em>conf.d</em> для Gentoo по стандартному для conf.d пути (/etc/conf.d/).  Функция создает все необходимые каталоги.</p>


	<p><strong>doenvd</strong> <em>&lt;запись env.d&gt; [другие записи env.d]</em></p>


	<p style="padding-left:4em;">Устанавливает записи <em>env.d</em> для Gentoo по стандартному для env.d пути (/etc/env.d/).  Функция создает все необходимые каталоги.</p>


	<p><strong>dolib</strong> <em>&lt;библиотека&gt;</em> <em>[другие библиотеки]</em></p>


	<p><strong>dolib.a</strong> <em>&lt;библиотека&gt;</em> <em>[другие библиотеки]</em></p>


	<p><strong>dolib.so</strong> <em>&lt;библиотека&gt;</em> <em>[другие библиотеки]</em></p>


	<p style="padding-left:4em;">Устанавливает одну или несколько библиотек в каталог <em>DESTTREE</em>/lib. Функция создает все необходимые каталоги.</p>


	<p><strong>libopts</strong> <em>[опции для install(1)]</em></p>


	<p style="padding-left:4em;">Может использоваться для задания опций утилите install, к которым обращаются функции <strong>dolib</strong>.  Значение по умолчанию - <em>-m0644</em>.</p>


	<p><strong>doman</strong> <em>[-i18n=&lt;локаль&gt;]</em> <em>&lt;man-файл&gt; [другие man-файлы]</em></p>


	<p style="padding-left:4em;">Устанавливает файлы man-руководств в каталог /usr/share/man/man[0-9], в зависимости от суффикса файла. Если это необходимо, файлы будут упакованы. Опция <em>-i18n</em> позволяет устанавливать руководства на определенном языке. Затем man-файлы будут установлены в каталог /usr/share/man/<em>&lt;локаль&gt;</em>/man[0-9]. Начиная с <strong>EAPI 2</strong> man-страницы для определенной локали, в имени которых содержится суффикс локали, устанавливаются в каталог /usr/share/man/<em>&lt;локаль&gt;</em>/man[0-9], причем часть имени файла, обозначающая локаль, удаляется, а опция <em>-i18n</em> будет проигнорирована. Например, если используется <strong>EAPI 2</strong>, man-страница с именем foo.<em>&lt;локаль&gt;</em>.1 будет установлена как /usr/share/man/<em>&lt;локаль&gt;</em>/man1/foo.1. Начиная с <strong>EAPI 4</strong> атрибут опции <em>-i18n</em> имеет приоритет перед суффиксом локали в имени файла.</p>


	<p><strong>dohard</strong> <em>&lt;имя файла&gt; &lt;имя ссылки&gt;</em></p>


	<p style="padding-left:4em;">Начиная с <strong>EAPI 4</strong> вспомогательная функция <strong>dohard</strong> не существует. Ебилды должны вызывать утилиту <strong>ln(1)</strong> напрямую.</p>


	<p><strong>dosym</strong> <em>&lt;имя файла&gt; &lt;имя ссылки&gt;</em></p>


	<p style="padding-left:4em;">Выполняет команду ln, создавая тем самым символическую ссылку.</p>


	<p><strong>doheader</strong> <em lang="-r"> &lt;имя файла&gt; [другие файлы]</em></p>


	<p style="padding-left:4em;">Устанавливает данные файлы заголовков в каталог /usr/include/ с правами по умолчанию <em>0644</em> (можно переопределить через функцию <strong>insopts</strong>). Опция -r включит в обработку содержимое подкаталогов. Вспомогательная функция <strong>doheader</strong> доступна начиная с <strong>EAPI 5</strong>.</p>


	<p><strong>dohtml</strong> _ [-a типы-файлов] [-r] [-x игнорируемые-каталоги] [файлы-и-каталоги]_</p>


	<p style="padding-left:4em;">Устанавливает файлы из списка файлов (разделяются пробелом) в каталог /usr/share/doc/${PF}/html, если файлы имеют расширение .htm, .html, .css, .js, .gif, .jpeg, .jpg или .png. Опция <em>-a</em> позволяет ограничить действие определенными типами файлов, опция <em>-A</em> добавляет типы к перечню по умолчанию, <em>-x</em> определяет каталоги, которые необходимо пропустить (по умолчанию пропускается CVS), <em>-p</em> определяет префикс документа, с опцией <em>-r</em> каталоги обрабатываются рекурсивно.</p>


	<p><strong>doinfo</strong> <em>&lt;info-файл&gt; [другие info-файлы]</em></p>


	<p style="padding-left:4em;">Устанавливает info-файлы в каталог <em>DESTDIR</em>/info.  Все они автоматически архивируются с помощью gzip.  Функция создает все необходимые каталоги.</p>


	<p><strong>domo</strong> _&lt;файл локали&gt; [другие файлы локали] _</p>


	<p style="padding-left:4em;">Устанавливает файлы локали в каталог <em>DESTDIR</em>/usr/share/locale/[ЯЗЫК], исходя из их суффикса.  Функция создает все необходимые каталоги.</p>


	<p><strong>fowners</strong> <em>&lt;права доступа&gt; &lt;файл&gt; [файлы]</em></p>


	<p><strong>fperms</strong> <em>&lt;права доступа&gt; &lt;файл&gt; [файлы]</em></p>


	<p style="padding-left:4em;">Выполняет chown (<strong>fowners</strong>) или chmod (<strong>fperms</strong>), назначая тем самым <em>права доступа к файлам</em>.</p>


	<p><strong>insinto</strong> <em>[путь]</em></p>


	<p style="padding-left:4em;">Устанавливает корневой каталог для функции <strong>doins</strong>. <br />По умолчанию им является /.</p>


	<p><strong>insopts</strong> <em>[опции для install(1)]</em></p>


	<p style="padding-left:4em;">Может быть использована для задания опций утилите install, используемой в функции <strong>doins</strong>.  Значение по умолчанию - <em>-m0644</em>.</p>


	<p><strong>doins</strong> <em lang="-r"> &lt;файл&gt; [другие файлы]</em></p>


	<p style="padding-left:4em;">Устанавливает файлы по пути, который управляется функцией <strong>insinto</strong>.  Эта функция использует утилиту <strong>install</strong>(1).  Все необходимые каталоги будут созданы. Опция -r устанавливает рекурсивный режим. Начиная с <strong>EAPI 4</strong> и <strong>doins</strong>, и <strong>newins</strong> сохраняют символические ссылки, тогда как в <strong>EAPI 3</strong> и более ранних версиях символические ссылки не сохранялись, а происходило разыменование.</p>


	<p><strong>exeinto</strong> <em>[путь]</em></p>


	<p style="padding-left:4em;">Устанавливает корневой каталог для функции <strong>doexe</strong>. <br />По умолчанию им является /.</p>


	<p><strong>exeopts</strong> <em>[опции для install(1)]</em></p>


	<p style="padding-left:4em;">Может использоваться для задания опций утилите install, используемых в функции <strong>doexe</strong>. Значение по умолчанию - <em>-m0755</em>.</p>


	<p><strong>doexe</strong> <em>&lt;исполняемый файл&gt; [другие исполняемые файлы]</em></p>


	<p style="padding-left:4em;">Устанавливает исполняемые файлы в каталог, управляемый <strong>exeinto</strong>.  Эта функция использует утилиту <strong>install</strong>(1). Функция создает все необходимые каталоги.</p>


	<p><strong>docinto</strong> <em>[путь]</em></p>


	<p style="padding-left:4em;">Назначает подкаталог, используемый функциями <strong>dodoc</strong> и <strong>dohtml</strong> при установке в дерево документов (на основе /usr/share/doc/${PF}/).  По умолчанию подкаталога либо нет, либо установлено значение "".</p>


	<p><strong>dodoc</strong> <em lang="-r"> &lt;документ&gt; [другие документы]</em></p>


	<p style="padding-left:4em;">Устанавливает один или несколько документов в каталог /usr/share/doc/${PF}/<em>&lt;путь docinto&gt;</em>. Документы помечаются для упаковки.  Функция создает все необходимые каталоги. Начиная с <strong>EAPI 4</strong> поддерживается рекурсивная обработка подкаталогов;  чтобы включить ее, используйте опцию <em>-r</em>.</p>


	<p><strong>newbin</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newsbin</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newinitd</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newconfd</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newenvd</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newlib.so</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newlib.a</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newman</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newinfo</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newins</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newexe</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p><strong>newdoc</strong> <em>&lt;прежний файл&gt; &lt;новое имя файла&gt;</em></p>


	<p style="padding-left:4em;">Все эти функции работают аналогично функциям <strong>do</strong>, но только с одним файлом, который устанавливается с <em>[новым именем]</em>. Начиная с <strong>EAPI 5</strong>, если первый параметр - дефис (-), происходит обращение к стандартному вводу.</p>


	<h2 id="ПРИМЕРЫ">ПРИМЕРЫ<a href="#ПРИМЕРЫ" class="wiki-anchor">&para;</a></h2>


<pre>
# Copyright 1999-2009 Gentoo Foundation 
# Distributed under the terms of the GNU General Public License v2 
# $Header: $ 

EAPI="5" 

inherit some_eclass another_eclass 

DESCRIPTION="Super-useful stream editor (sed)" 
HOMEPAGE="http://www.gnu.org/software/sed/sed.html" 
SRC_URI="ftp://alpha.gnu.org/pub/gnu/${PN}/${P}.tar.gz" 

LICENSE="GPL-2" 
SLOT="0" 
KEYWORDS="~x86" 
IUSE="" 

RDEPEND="" 
DEPEND="nls? ( sys-devel/gettext )" 

src_configure() { 
    econf 
        --bindir="${EPREFIX}"/bin 
} 

src_install() { 
    emake DESTDIR="${D}" install 
    dodoc NEWS README* THANKS AUTHORS BUGS ChangeLog 
} 
</pre>

	<h2 id="ФАЙЛЫ">ФАЙЛЫ<a href="#ФАЙЛЫ" class="wiki-anchor">&para;</a></h2>


	<p>Сценарий <em>/usr/sbin/ebuild.sh</em>.</p>


	<p>Вспомогательные приложения в каталоге <em>/usr/lib/portage/bin</em>.</p>


	<p><strong>/etc/make.conf</strong></p>


	<p style="padding-left:4em;">Содержит переменные для процесса сборки; они имеют приоритет над заданными в make.defaults.</p>


	<p><strong>/usr/share/portage/config/make.globals</strong></p>


	<p style="padding-left:4em;">Содержит переменные по умолчанию для процесса сборки. Редактировать значения следует не здесь, а в файле /etc/make.conf.</p>


	<p><strong>/etc/portage/color.map</strong></p>


	<p style="padding-left:4em;">Содержит переменные для пользовательских настроек цветного вывода.</p>


	<h2 id="СМ-ТАКЖЕ">СМ. ТАКЖЕ<a href="#СМ-ТАКЖЕ" class="wiki-anchor">&para;</a></h2>


	<p><strong><a href="ebuild.html" class="wiki-page">ebuild</a></strong> <strong>(1),</strong> <strong><a href=".html" class="wiki-page">make.conf</a></strong> <strong>(5),</strong> <strong><a href=".html" class="wiki-page">color.map</a></strong> <strong>(5)</strong></p>


	<h2 id="БАГТРЕКЕР">БАГТРЕКЕР<a href="#БАГТРЕКЕР" class="wiki-anchor">&para;</a></h2>


	<p>Об обнаруженных ошибках сообщайте на <noindex><a class="external" href="http://bugs.gentoo.org/" ref="nofollow">http://bugs.gentoo.org/</a></noindex>.</p>


	<h2 id="АВТОРЫ">АВТОРЫ<a href="#АВТОРЫ" class="wiki-anchor">&para;</a></h2>


	<ul>
	<li>Achim Gottinger &lt;<a class="email" href="mailto:achim@gentoo.org">achim@gentoo.org</a>&gt; </li>
		<li>Mark Guertin &lt;<a class="email" href="mailto:gerk@gentoo.org">gerk@gentoo.org</a>&gt; </li>
		<li>Nicholas Jones &lt;<a class="email" href="mailto:carpaski@gentoo.org">carpaski@gentoo.org</a>&gt; </li>
		<li>Mike Frysinger &lt;<a class="email" href="mailto:vapier@gentoo.org">vapier@gentoo.org</a>&gt; </li>
		<li>Arfrever Frehtes Taifersar Arahesis &lt;<a class="email" href="mailto:Arfrever.FTA@gmail.com">Arfrever.FTA@gmail.com</a>&gt; </li>
		<li>Fabian Groffen &lt;<a class="email" href="mailto:grobian@gentoo.org">grobian@gentoo.org</a>&gt;</li>
	</ul>


	<h2 id="ПЕРЕВОД">ПЕРЕВОД<a href="#ПЕРЕВОД" class="wiki-anchor">&para;</a></h2>


	<ul>
	<li>Елена Гаврилова &lt;<a class="email" href="mailto:e.vl.gavrilova@yandex.ru">e.vl.gavrilova@yandex.ru</a>&gt;</li>
	</ul>


	<p>&nbsp;<br />&nbsp;</p>


	<p>Октябрь 2012</p>
</body>
</html>
