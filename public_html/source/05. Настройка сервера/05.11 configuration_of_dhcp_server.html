<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>configuration of dhcp server</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style>
body { font:80% Verdana,Tahoma,Arial,sans-serif; }
h1, h2, h3, h4 {  font-family: "Trebuchet MS",Georgia,"Times New Roman",serif; }
ul.toc { padding: 4px; margin-left: 0; }
ul.toc li { list-style-type:none; }
ul.toc li.heading2 { margin-left: 1em; }
ul.toc li.heading3 { margin-left: 2em; }
a.wiki-anchor { display: none; margin-left: 6px; text-decoration: none; }
a.wiki-anchor:hover { color: #aaa !important; text-decoration: none; }
h1:hover a.wiki-anchor, h2:hover a.wiki-anchor, h3:hover a.wiki-anchor { display: inline; color: #ddd; }
pre {font-size:133% }
</style>
</head>
<body>
<h1 id="Настройка-DHCP-сервера">Настройка DHCP сервера<a href="#Настройка-DHCP-сервера" class="wiki-anchor">&para;</a></h1>


	<h2 id="Установка-DHCP-сервиса-в-систему">Установка DHCP сервиса в систему<a href="#Установка-DHCP-сервиса-в-систему" class="wiki-anchor">&para;</a></h2>


	<p>Поддержка DHCP сервиса появилась в пакете <a href="calculate-server.html" class="wiki-page new">calculate-server</a> <em>2.1.4</em>.<br />В качестве сервера используется dhcpd.</p>


	<p><strong>Перед установкой</strong></p>


	<p>Убедитесь что у вас поднят сетевой интерфейс, интерфейсу присвоен ip находящийся в сети которая будет указана при установке сервиса DHCP (параметр командной строки установки сервиса --net).</p>


	<p>Убедитесь что у вас в системе установлен сервис dns, если он не был установлен, выполните установку командой:<br /><pre>
cl-setup dns
</pre></p>


	<p>Установка DHCP сервиса выполняется командой<br /><pre>
cl-setup --router &lt;ip шлюза&gt; --dnames &lt;имена доменов&gt; --range &lt;диапазон ip&gt; --net &lt;ip сети с маской /24&gt; --dnsip &lt;ip DNS сервера&gt; dhcp
</pre></p>


	<p>Параметры:</p>


	<ul>
	<li>--router - ip адрес передаваемый клиентскому компьютеру в качестве шлюза по умолчанию</li>
		<li>--dnames - доменные имена передаваемые клиентскому компьютеру в качестве доменых имен для поиска, разделитель имен запятая. Первое имя используется для создания DNS домена на серверном компьютере в который будут добавлены компьютеры подключающиеся к сети.</li>
		<li>--range - диапазон адресов из которого клиентский компьютер получает свой ip, два ip адреса разделенные запятой.</li>
		<li>--net - cеть в которой будут находиться клиентские компьютеры</li>
		<li>--dnsip - ip адрес DNS сервера передаваемый клиентскому компьютеру</li>
	</ul>


	<p>Примечание: для того чтобы клиентские компьютеры находили себя в DNS, параметр --dnsip должен указывать на текущий сервер с устанавливаемым сервисом DHCP</p>


	<p>Пример (текущий сервер где устанавливаем DHCP сервис имеет ip 10.0.0.5):<br /><pre>
cl-setup --router 10.0.0.1 --dnames domain.ru,domain.org --range 10.0.0.20,10.0.0.100 --net 10.0.0.0/24 --dnsip 10.0.0.5 dhcp
</pre></p>


	<p>ВAЖНО: При установке сервиса DHCP изменяется доменное имя сервера на имя_хоста.первое_доменное_имя_для_поиска, если уже были настроены сервисы "FTP","SAMBA","MAIL", "PROXY", "JABBER" то необходимо первым доменным именем для поиска указать текущий домен, параметр "--dnames текущий_домен" (для его получения выполните команду hostname -d перед установкой сервиса). Второй вариант: необходимо в DNS прописать предыдущее полное имя сервера указывающее на его ip адрес)</p>


	<h2 id="Управление-DHCP-сервисом">Управление DHCP сервисом<a href="#Управление-DHCP-сервисом" class="wiki-anchor">&para;</a></h2>


	<h3 id="Управление-статическими-хостами-DHCP-сервиса">Управление статическими хостами DHCP сервиса<a href="#Управление-статическими-хостами-DHCP-сервиса" class="wiki-anchor">&para;</a></h3>


	<h4>Создание статического хоста DHCP</h4>


	<p>Для создания статического используется команда<br /><pre>
cl-dhcp-hostadd --host &lt;название хоста&gt; --ip &lt;ip адрес&gt; --mac &lt;mac адрес&gt;
</pre></p>


Параметры:
	<ul>
	<li>--host - название клиентского компьютера, (название без домена)</li>
		<li>--ip - ip адрес который будет назначен клиентскому компьютеру</li>
		<li>--mac - mac адрес клиентского компьютера (можно узнать командой ifconfig)</li>
	</ul>


	<p>Пример:<br /><pre>
cl-dhcp-hostadd --host test --ip 10.0.0.20 --mac 00:17:31:c2:88:82
</pre></p>


	<h4>Модификация параметров статического хоста</h4>


	<p>Для модификации статического хоста используется команда<br /><pre>
cl-dhcp-hostmod [параметры] название_хоста
</pre></p>


Параметры:
	<ul>
	<li>--ip - измененный ip адрес который будет назначен клиентскому компьютеру</li>
		<li>--mac - изменненный mac адрес клиентского компьютера</li>
	</ul>


	<p>Пример:<br /><pre>
cl-dhcp-hostmod --ip 10.0.0.25 test
</pre></p>


	<h4>Удаление статического хоста</h4>


	<p>Для удаления статического хоста используется команда<br /><pre>
cl-dhcp-hostdel --host &lt;название хоста&gt;
</pre></p>


Параметры:
	<ul>
	<li>--host - название клиентского компьютера, (название без домена)</li>
	</ul>


	<p>Пример:<br /><pre>
cl-dhcp-hostdel --host test
</pre></p>


	<h3 id="Управление-сетями-DHCP-сервиса">Управление сетями DHCP сервиса<a href="#Управление-сетями-DHCP-сервиса" class="wiki-anchor">&para;</a></h3>


	<h4>Создание сети DHCP</h4>


	<p><em>На каждый сетевой интерфейс может быть создана только одна сеть.</em></p>


	<p>Для создания сети используется команда<br /><pre>
cl-dhcp-netadd --router &lt;ip роутера&gt; --dnames &lt;имена доменов&gt; --range &lt;диапазон ip для динамических хостов&gt; --net &lt;ip сети с маской /24&gt; --dnsip &lt;ip DNS сервера&gt; dhcp
</pre></p>


Параметры:
	<ul>
	<li>--router - ip адрес передаваемый клиентскому компьютеру в качестве шлюза по умолчанию</li>
		<li>--dnames - доменные имена передаваемые клиентскому компьютеру в качестве доменых имен для поиска, разделитель имен запятая. Первое имя используется для создания DNS домена на серверном компьютере в который будут добавлены компьютеры подключающиеся к сети.</li>
		<li>--range - диапазон адресов из которого клиентский компьютер получает свой ip, два ip адреса разделенные запятой.</li>
		<li>--net - cеть в которой будут находится клиентские компьютеры</li>
		<li>--dnsip - ip адрес DNS сервера передаваемый клиентскому компьютеру</li>
	</ul>


	<p>Пример:<br /><pre>
cl-dhcp-netadd --router 10.0.0.1 --dnames domain.ru,domain.org --range 10.0.0.20,10.0.0.100 --net 10.0.0.0/24 --dnsip 10.0.0.5
</pre></p>


	<h4>Модификация параметров сети DHCP</h4>


	<p>Для модификации параметров сети используется команда<br /><pre>
cl-dhcp-netmod  [параметры] ip_и_маска_сети
</pre></p>


Параметры:
	<ul>
	<li>--router - измененный ip адрес передаваемый клиентскому компьютеру в качестве шлюза по умолчанию.</li>
		<li>--dnames - измененные доменные имена передаваемые клиентскому компьютеру в качестве доменых имен для поиска, разделитель имен запятая. Первое имя используется для создания DNS домена на серверном компьютере в который будут добавлены компьютеры подключающиеся к сети.</li>
		<li>--range - измененный диапазон динамических адресов которые раздаются клиентским компьютерам.</li>
		<li>--dnsip - измененный ip адрес DNS сервера передаваемый клиентскому компьютеру</li>
	</ul>


	<p>Пример:<br /><pre>
cl-dhcp-netmod --range 10.0.0.50,10.0.0.255 10.0.0.0/24
cl-dhcp-netmod --router 10.0.0.1 10.0.0.0/24
</pre></p>


	<h4>Удаление cети DHCP</h4>


	<p><em>Если существует только одна сеть DHCP то ее удаление приведет к невозможности запуска DHCP сервера добавление новой сети вернет работоспособность.</em></p>


	<p>Для удаления сети используется команда<br /><pre>
cl-dhcp-netdel --net ip_и_маска_сети
</pre></p>


Параметры:
	<ul>
	<li>--net удаляемая сеть</li>
	</ul>


	<p>Пример:<br /><pre>
cl-dhcp-netdel --net 10.0.0.0/24
</pre></p>


	<h2 id="Информация-о-DHCP-сервисе">Информация о DHCP сервисе<a href="#Информация-о-DHCP-сервисе" class="wiki-anchor">&para;</a></h2>


	<p>Для получения информации о записях и зонах DNS сервиса используется команда <em>cl-info</em>.</p>


	<h3 id="Информация-о-всех-сетях">Информация о всех сетях<a href="#Информация-о-всех-сетях" class="wiki-anchor">&para;</a></h3>


<pre>
cl-info -n dhcp
</pre>

	<h3 id="Информация-о-cети">Информация о cети<a href="#Информация-о-cети" class="wiki-anchor">&para;</a></h3>


<pre>
cl-info -N &lt;ip_и_маска_сети&gt; dhcp
</pre>

	<p>Пример.<br /><pre>
cl-info -N 10.0.0.0/24 dhcp
</pre></p>


	<p>Информация о сети 10.0.0.0/24</p>


	<h3 id="Информация-о-всех-статических-хостах">Информация о всех статических хостах==<a href="#Информация-о-всех-статических-хостах" class="wiki-anchor">&para;</a></h3>


<pre>
cl-info --hosts dhcp
</pre>

	<h3 id="Информация-о-статическом-хосте">Информация о статическом хосте<a href="#Информация-о-статическом-хосте" class="wiki-anchor">&para;</a></h3>


<pre>
cl-info -H &lt;название хоста&gt; dhcp
</pre>

	<p>Пример.<br /><pre>
cl-info -H computer dhcp
</pre><br />Информация о статическом хосте computer.</p>
</body>
</html>
